{"ast":null,"code":"import _objectSpread from\"C:/Project/HopewellClinic/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React from'react';import{BrowserRouter as Router,Routes,Route,Navigate}from'react-router-dom';import{AuthProvider,useAuth}from'./contexts/AuthContext';import LandingPage from'./components/LandingPage';import AuthPage from'./components/AuthPage';import PatientDashboard from'./components/PatientDashboard';import DoctorDashboard from'./components/DoctorDashboard';import AdminDashboard from'./components/AdminDashboard';import NurseDashboard from'./components/NurseDashboard';import LoadingSpinner from'./components/LoadingSpinner';// Import the existing API functions\nimport{appointmentsAPI,servicesAPI,patientsAPI,staffAPI,adminAPI}from'./services/api';// Protected Route component\nimport{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";const ProtectedRoute=_ref=>{let{children,allowedRoles=[]}=_ref;const{isAuthenticated,isLoading,hasAnyRole}=useAuth();if(isLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center\",children:/*#__PURE__*/_jsx(LoadingSpinner,{})});}if(!isAuthenticated){return/*#__PURE__*/_jsx(Navigate,{to:\"/auth\",replace:true});}if(allowedRoles.length>0&&!hasAnyRole(allowedRoles)){return/*#__PURE__*/_jsx(Navigate,{to:\"/unauthorized\",replace:true});}return/*#__PURE__*/_jsx(_Fragment,{children:children});};// Dashboard wrapper component that handles data loading\nconst DashboardWrapper=_ref2=>{let{children,user}=_ref2;const[appointments,setAppointments]=React.useState([]);const[services,setServices]=React.useState([]);const[doctors,setDoctors]=React.useState([]);const[availableSlots,setAvailableSlots]=React.useState([]);const[patientId,setPatientId]=React.useState(null);const[isLoading,setIsLoading]=React.useState(true);const[isBooking,setIsBooking]=React.useState(false);const[bookingError,setBookingError]=React.useState('');const loadDashboardData=async()=>{try{setIsLoading(true);// Get the Patient ID from the ApplicationUser ID\ntry{const patient=await patientsAPI.getByUserId(user.id);setPatientId(patient.id);}catch(error){console.log('⚠️ Patient API not available, using mock data');setPatientId('mock-patient-id');}// Try to load data, but don't fail if APIs are not available\ntry{const[appointmentsData,servicesData,doctorsData]=await Promise.all([appointmentsAPI.getByPatient(patientId||'mock-patient-id'),servicesAPI.getAll(),staffAPI.getByRole('doctor')]);setAppointments(appointmentsData);setServices(servicesData);setDoctors(doctorsData);}catch(error){console.log('⚠️ Some APIs not available, using mock data');// Set mock data instead of failing\nsetAppointments([]);setServices([{id:'1',name:'General Consultation',description:'Basic health checkup',durationMinutes:30},{id:'2',name:'Follow-up Visit',description:'Follow-up appointment',durationMinutes:15}]);setDoctors([{id:'1',firstName:'Dr. John',lastName:'Smith',email:'doctor@hopewell.com'},{id:'2',firstName:'Dr. Jane',lastName:'Doe',email:'jane@hopewell.com'}]);}}catch(error){console.error('Error loading dashboard data:',error);// Set empty data instead of failing\nsetAppointments([]);setServices([]);setDoctors([]);}finally{setIsLoading(false);}};const loadAvailableSlots=async date=>{try{console.log('Loading available slots for date:',date);const slots=await appointmentsAPI.getAvailable(date);console.log('Available slots received:',slots);// Calculate the day of the week for the requested date\nconst requestedDate=new Date(date);const dayOfWeek=requestedDate.getDay();// 0 = Sunday, 1 = Monday, etc.\n// Filter slots to only include the correct day of the week\nconst filteredSlots=slots.filter(slot=>slot.dayOfWeek===dayOfWeek);console.log('Filtered slots for day',dayOfWeek,':',filteredSlots);setAvailableSlots(filteredSlots);}catch(error){console.error('Error loading available slots:',error);setAvailableSlots([]);}};const handleBookAppointment=async bookingData=>{try{setIsBooking(true);setBookingError('');// Calculate end time based on service duration\nconst selectedService=services.find(s=>s.id===bookingData.serviceId);// Ensure startTime is in HH:mm:ss format\nconst startTimeFormatted=bookingData.startTime.includes(':')&&bookingData.startTime.split(':').length===2?bookingData.startTime+':00':bookingData.startTime;const startTime=new Date(\"2000-01-01T\".concat(startTimeFormatted));const endTime=new Date(startTime.getTime()+((selectedService===null||selectedService===void 0?void 0:selectedService.durationMinutes)||30)*60000);const endTimeString=endTime.toTimeString().slice(0,8);// Format as HH:mm:ss\nawait appointmentsAPI.create({patientId:patientId,serviceId:bookingData.serviceId,staffId:bookingData.staffId,appointmentDate:bookingData.appointmentDate,startTime:startTimeFormatted,endTime:endTimeString,notes:bookingData.notes||''});// Refresh appointments\nawait loadDashboardData();}catch(error){var _error$response,_error$response$data;console.error('Error booking appointment:',error);setBookingError(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.error)||error.message||'Failed to book appointment');}finally{setIsBooking(false);}};const handleUpdateAppointment=async(appointmentId,updateData)=>{try{setIsBooking(true);setBookingError('');// Calculate end time based on service duration\nconst selectedService=services.find(s=>s.id===updateData.serviceId);// Ensure startTime is in HH:mm:ss format\nconst startTimeFormatted=updateData.startTime.includes(':')&&updateData.startTime.split(':').length===2?updateData.startTime+':00':updateData.startTime;const startTime=new Date(\"2000-01-01T\".concat(startTimeFormatted));const endTime=new Date(startTime.getTime()+((selectedService===null||selectedService===void 0?void 0:selectedService.durationMinutes)||30)*60000);const endTimeString=endTime.toTimeString().slice(0,8);// Format as HH:mm:ss\nawait appointmentsAPI.update(appointmentId,{appointmentDate:updateData.appointmentDate,startTime:startTimeFormatted,endTime:endTimeString,notes:updateData.notes||''});// Refresh appointments\nawait loadDashboardData();}catch(error){var _error$response2,_error$response2$data;console.error('Error updating appointment:',error);setBookingError(((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.error)||error.message||'Failed to update appointment');}finally{setIsBooking(false);}};const handleCancelAppointment=async appointmentId=>{try{setIsBooking(true);setBookingError('');await appointmentsAPI.delete(appointmentId);// Refresh appointments\nawait loadDashboardData();}catch(error){var _error$response3,_error$response3$data;console.error('Error canceling appointment:',error);setBookingError(((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.error)||error.message||'Failed to cancel appointment');}finally{setIsBooking(false);}};React.useEffect(()=>{// Add a small delay to ensure user is fully logged in before making API calls\nconst timer=setTimeout(()=>{loadDashboardData();},100);return()=>clearTimeout(timer);},[user.id]);// Call children as a function with props\nreturn children({user,appointments,services,doctors,availableSlots,isLoading,isBooking,bookingError,onBookAppointment:handleBookAppointment,onUpdateAppointment:handleUpdateAppointment,onCancelAppointment:handleCancelAppointment,onLoadAvailableSlots:loadAvailableSlots});};// Doctor Dashboard wrapper component that handles doctor-specific data loading\nconst DoctorDashboardWrapper=_ref3=>{let{children,user}=_ref3;const[appointments,setAppointments]=React.useState([]);const[patients,setPatients]=React.useState([]);const[shiftSchedule,setShiftSchedule]=React.useState([]);const[isLoading,setIsLoading]=React.useState(true);const[isProcessing,setIsProcessing]=React.useState(false);const[error,setError]=React.useState('');const loadDashboardData=async()=>{try{setIsLoading(true);setError('');// For now, use existing endpoints that work\n// Get all appointments (we'll filter by doctor later when backend supports it)\ntry{const appointmentsData=await appointmentsAPI.getAll();// Filter appointments for this doctor (when staffId is available)\nsetAppointments(appointmentsData);}catch(appointmentsError){console.log('No appointments endpoint available yet');setAppointments([]);}// Get all patients (we'll filter by doctor later when backend supports it)\ntry{const patientsData=await patientsAPI.getAll();setPatients(patientsData);}catch(patientsError){console.log('No patients endpoint available yet');setPatients([]);}// Initialize empty shift schedule (backend not implemented yet)\nsetShiftSchedule([]);}catch(error){var _error$response4,_error$response4$data;console.error('Error loading doctor dashboard data:',error);setError(((_error$response4=error.response)===null||_error$response4===void 0?void 0:(_error$response4$data=_error$response4.data)===null||_error$response4$data===void 0?void 0:_error$response4$data.error)||error.message||'Failed to load dashboard data');}finally{setIsLoading(false);}};const handleApproveAppointment=async appointmentId=>{try{setIsProcessing(true);setError('');// For now, just update the appointment status using existing endpoint\nawait appointmentsAPI.updateStatus(appointmentId,'confirmed');await loadDashboardData();// Refresh data\n}catch(error){var _error$response5,_error$response5$data;console.error('Error approving appointment:',error);setError(((_error$response5=error.response)===null||_error$response5===void 0?void 0:(_error$response5$data=_error$response5.data)===null||_error$response5$data===void 0?void 0:_error$response5$data.error)||error.message||'Failed to approve appointment');}finally{setIsProcessing(false);}};const handleRejectAppointment=async(appointmentId,reason)=>{try{setIsProcessing(true);setError('');// For now, just update the appointment status using existing endpoint\nawait appointmentsAPI.updateStatus(appointmentId,'cancelled');await loadDashboardData();// Refresh data\n}catch(error){var _error$response6,_error$response6$data;console.error('Error rejecting appointment:',error);setError(((_error$response6=error.response)===null||_error$response6===void 0?void 0:(_error$response6$data=_error$response6.data)===null||_error$response6$data===void 0?void 0:_error$response6$data.error)||error.message||'Failed to reject appointment');}finally{setIsProcessing(false);}};const handleUpdateShiftSchedule=async shiftData=>{try{setIsProcessing(true);setError('');// For now, just store locally (backend not implemented yet)\nconsole.log('Shift schedule update requested:',shiftData);setShiftSchedule(shiftData);// Simulate success\nawait new Promise(resolve=>setTimeout(resolve,1000));}catch(error){var _error$response7,_error$response7$data;console.error('Error updating shift schedule:',error);setError(((_error$response7=error.response)===null||_error$response7===void 0?void 0:(_error$response7$data=_error$response7.data)===null||_error$response7$data===void 0?void 0:_error$response7$data.error)||error.message||'Failed to update shift schedule');}finally{setIsProcessing(false);}};const handleViewPatientDetails=async patientId=>{try{setError('');// For now, just log the request (backend not implemented yet)\nconsole.log('View patient details requested for:',patientId);}catch(error){var _error$response8,_error$response8$data;console.error('Error loading patient details:',error);setError(((_error$response8=error.response)===null||_error$response8===void 0?void 0:(_error$response8$data=_error$response8.data)===null||_error$response8$data===void 0?void 0:_error$response8$data.error)||error.message||'Failed to load patient details');}};React.useEffect(()=>{// Add a small delay to ensure user is fully logged in before making API calls\nconst timer=setTimeout(()=>{loadDashboardData();},100);return()=>clearTimeout(timer);},[user.id]);// Call children as a function with props\nreturn children({user,appointments,patients,shiftSchedule,isLoading,isProcessing,error,onApproveAppointment:handleApproveAppointment,onRejectAppointment:handleRejectAppointment,onUpdateShiftSchedule:handleUpdateShiftSchedule,onViewPatientDetails:handleViewPatientDetails});};// Nurse Dashboard wrapper component that handles nurse-specific data loading\nconst NurseDashboardWrapper=_ref4=>{let{children,user}=_ref4;const[appointments,setAppointments]=React.useState([]);const[services,setServices]=React.useState([]);const[doctors,setDoctors]=React.useState([]);const[isLoading,setIsLoading]=React.useState(true);const[isProcessing,setIsProcessing]=React.useState(false);const[error,setError]=React.useState('');const loadDashboardData=async()=>{try{setIsLoading(true);setError('');// Load appointments\ntry{const appointmentsData=await appointmentsAPI.getAll();setAppointments(appointmentsData);}catch(appointmentsError){console.log('No appointments endpoint available yet');setAppointments([]);}// Load services\ntry{const servicesData=await servicesAPI.getAll();setServices(servicesData);}catch(servicesError){console.log('No services endpoint available yet');setServices([]);}// Load doctors (staff with doctor role)\ntry{const staffData=await staffAPI.getAll();const doctorsData=staffData.filter(staff=>staff.role==='doctor');setDoctors(doctorsData);}catch(staffError){console.log('No staff endpoint available yet');setDoctors([]);}}catch(error){var _error$response9,_error$response9$data;console.error('Error loading nurse dashboard data:',error);setError(((_error$response9=error.response)===null||_error$response9===void 0?void 0:(_error$response9$data=_error$response9.data)===null||_error$response9$data===void 0?void 0:_error$response9$data.error)||error.message||'Failed to load dashboard data');}finally{setIsLoading(false);}};React.useEffect(()=>{loadDashboardData();},[]);const handleBookWalkInAppointment=async appointmentData=>{try{setIsProcessing(true);setError('');// Create a walk-in appointment with immediate scheduling\nconst walkInAppointment=_objectSpread(_objectSpread({},appointmentData),{},{appointmentDate:new Date().toISOString().split('T')[0],// Today\nstartTime:new Date().toTimeString().slice(0,5),// Current time\nstatus:'walkin',notes:\"Walk-in appointment: \".concat(appointmentData.notes||'No additional notes')});await appointmentsAPI.create(walkInAppointment);await loadDashboardData();// Refresh data\n}catch(error){var _error$response0,_error$response0$data;console.error('Error booking walk-in appointment:',error);setError(((_error$response0=error.response)===null||_error$response0===void 0?void 0:(_error$response0$data=_error$response0.data)===null||_error$response0$data===void 0?void 0:_error$response0$data.error)||error.message||'Failed to book walk-in appointment');}finally{setIsProcessing(false);}};const handleApproveAppointmentForDoctor=async(appointmentId,doctorId)=>{try{setIsProcessing(true);setError('');// Update appointment with doctor assignment and approval\nawait appointmentsAPI.update(appointmentId,{staffId:doctorId,status:'confirmed'});await loadDashboardData();// Refresh data\n}catch(error){var _error$response1,_error$response1$data;console.error('Error approving appointment for doctor:',error);setError(((_error$response1=error.response)===null||_error$response1===void 0?void 0:(_error$response1$data=_error$response1.data)===null||_error$response1$data===void 0?void 0:_error$response1$data.error)||error.message||'Failed to approve appointment');}finally{setIsProcessing(false);}};const handleRejectAppointment=async(appointmentId,reason)=>{try{setIsProcessing(true);setError('');await appointmentsAPI.update(appointmentId,{status:'cancelled',notes:\"Rejected by nurse: \".concat(reason)});await loadDashboardData();// Refresh data\n}catch(error){var _error$response10,_error$response10$dat;console.error('Error rejecting appointment:',error);setError(((_error$response10=error.response)===null||_error$response10===void 0?void 0:(_error$response10$dat=_error$response10.data)===null||_error$response10$dat===void 0?void 0:_error$response10$dat.error)||error.message||'Failed to reject appointment');}finally{setIsProcessing(false);}};return children({user,appointments,services,doctors,isLoading,isProcessing,error,onBookWalkInAppointment:handleBookWalkInAppointment,onApproveAppointmentForDoctor:handleApproveAppointmentForDoctor,onRejectAppointment:handleRejectAppointment,onLogout:()=>{localStorage.removeItem('token');window.location.href='/auth';}});};// Admin Dashboard wrapper component that handles admin-specific data loading\nconst AdminDashboardWrapper=_ref5=>{let{children,user}=_ref5;const[users,setUsers]=React.useState([]);const[appointments,setAppointments]=React.useState([]);const[services,setServices]=React.useState([]);const[isLoading,setIsLoading]=React.useState(true);const[isProcessing,setIsProcessing]=React.useState(false);const[error,setError]=React.useState('');const loadDashboardData=async()=>{try{setIsLoading(true);setError('');// Get all staff members\ntry{const staffData=await staffAPI.getAll();console.log('Staff data received:',staffData);setUsers(staffData);}catch(staffError){console.log('No staff endpoint available, falling back to users');const usersData=await adminAPI.getUsers();console.log('Users data received:',usersData);setUsers(usersData);}// Get all appointments (we'll need to implement this endpoint)\ntry{// For now, we'll use the existing appointments API\nconst appointmentsData=await appointmentsAPI.getAll();setAppointments(appointmentsData);}catch(appointmentsError){console.log('No appointments endpoint available yet');setAppointments([]);}// Load services\ntry{const servicesData=await servicesAPI.getAll();setServices(servicesData);}catch(servicesError){console.log('No services endpoint available yet');setServices([]);}}catch(error){var _error$response11,_error$response11$dat;console.error('Error loading admin dashboard data:',error);setError(((_error$response11=error.response)===null||_error$response11===void 0?void 0:(_error$response11$dat=_error$response11.data)===null||_error$response11$dat===void 0?void 0:_error$response11$dat.error)||error.message||'Failed to load dashboard data');}finally{setIsLoading(false);}};const handleToggleUserStatus=async(userId,isActive)=>{try{setIsProcessing(true);setError('');await adminAPI.updateUserStatus(userId,isActive);await loadDashboardData();// Refresh data\n}catch(error){var _error$response12,_error$response12$dat;console.error('Error updating user status:',error);setError(((_error$response12=error.response)===null||_error$response12===void 0?void 0:(_error$response12$dat=_error$response12.data)===null||_error$response12$dat===void 0?void 0:_error$response12$dat.error)||error.message||'Failed to update user status');}finally{setIsProcessing(false);}};const handleUpdateUserRole=async(userId,newRole)=>{try{setIsProcessing(true);setError('');await adminAPI.updateUserRole(userId,newRole);await loadDashboardData();// Refresh data\n}catch(error){var _error$response13,_error$response13$dat;console.error('Error updating user role:',error);setError(((_error$response13=error.response)===null||_error$response13===void 0?void 0:(_error$response13$dat=_error$response13.data)===null||_error$response13$dat===void 0?void 0:_error$response13$dat.error)||error.message||'Failed to update user role');}finally{setIsProcessing(false);}};const handleCreateStaff=async staffData=>{try{setIsProcessing(true);setError('');await adminAPI.createStaff(staffData);await loadDashboardData();// Refresh data\n}catch(error){var _error$response14,_error$response14$dat;console.error('Error creating staff:',error);setError(((_error$response14=error.response)===null||_error$response14===void 0?void 0:(_error$response14$dat=_error$response14.data)===null||_error$response14$dat===void 0?void 0:_error$response14$dat.error)||error.message||'Failed to create staff member');}finally{setIsProcessing(false);}};const handleCreateService=async serviceData=>{try{setIsProcessing(true);setError('');await servicesAPI.create(serviceData);await loadDashboardData();// Refresh data\n}catch(error){var _error$response15,_error$response15$dat;console.error('Error creating service:',error);setError(((_error$response15=error.response)===null||_error$response15===void 0?void 0:(_error$response15$dat=_error$response15.data)===null||_error$response15$dat===void 0?void 0:_error$response15$dat.error)||error.message||'Failed to create service');}finally{setIsProcessing(false);}};const handleUpdateService=async(serviceId,serviceData)=>{try{setIsProcessing(true);setError('');await servicesAPI.update(serviceId,serviceData);await loadDashboardData();// Refresh data\n}catch(error){var _error$response16,_error$response16$dat;console.error('Error updating service:',error);setError(((_error$response16=error.response)===null||_error$response16===void 0?void 0:(_error$response16$dat=_error$response16.data)===null||_error$response16$dat===void 0?void 0:_error$response16$dat.error)||error.message||'Failed to update service');}finally{setIsProcessing(false);}};const handleDeleteService=async serviceId=>{try{setIsProcessing(true);setError('');// Check if service is being used by any appointments\nconst appointmentsUsingService=appointments.filter(apt=>apt.service.id===serviceId);if(appointmentsUsingService.length>0){setError(\"Cannot delete service. It is currently being used by \".concat(appointmentsUsingService.length,\" appointment(s). Please cancel or reschedule these appointments first.\"));return;}console.log('Attempting to delete service:',serviceId);const deleteResult=await servicesAPI.delete(serviceId);console.log('Delete result:',deleteResult);await loadDashboardData();// Refresh data\n}catch(error){var _error$response17,_error$response17$dat,_error$response18,_error$response18$dat;console.error('Error deleting service:',error);// Provide more specific error messages\nlet errorMessage='Failed to delete service';if((_error$response17=error.response)!==null&&_error$response17!==void 0&&(_error$response17$dat=_error$response17.data)!==null&&_error$response17$dat!==void 0&&_error$response17$dat.error){errorMessage=error.response.data.error;}else if((_error$response18=error.response)!==null&&_error$response18!==void 0&&(_error$response18$dat=_error$response18.data)!==null&&_error$response18$dat!==void 0&&_error$response18$dat.message){errorMessage=error.response.data.message;}else if(error.message){errorMessage=error.message;}// Check for common database constraint errors\nif(errorMessage.includes('foreign key')||errorMessage.includes('constraint')||errorMessage.includes('reference')){errorMessage='Cannot delete service. It is currently being used by existing appointments. Please cancel or reschedule these appointments first.';}setError(errorMessage);}finally{setIsProcessing(false);}};React.useEffect(()=>{loadDashboardData();},[user.id]);// Call children as a function with props\nreturn children({user,users,appointments,services,isLoading,isProcessing,error,onToggleUserStatus:handleToggleUserStatus,onUpdateUserRole:handleUpdateUserRole,onCreateStaff:handleCreateStaff,onCreateService:handleCreateService,onUpdateService:handleUpdateService,onDeleteService:handleDeleteService,onLogout:()=>{localStorage.removeItem('token');window.location.href='/auth';}});};// Main App Routes component\nconst AppRoutes=()=>{var _user$roles,_user$roles2,_user$roles3;const{isAuthenticated,user,login,register,logout,isLoading,error,clearError}=useAuth();const handleLogin=async(email,password)=>{try{await login({email,password});}catch(err){// Error is handled by AuthContext\n}};const handleRegister=async userData=>{try{await register(userData);}catch(err){// Error is handled by AuthContext\n}};const handleLogout=()=>{logout();};if(isLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center\",children:/*#__PURE__*/_jsx(LoadingSpinner,{})});}return/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(LandingPage,{})}),/*#__PURE__*/_jsx(Route,{path:\"/auth\",element:isAuthenticated?/*#__PURE__*/_jsx(Navigate,{to:user!==null&&user!==void 0&&(_user$roles=user.roles)!==null&&_user$roles!==void 0&&_user$roles.includes('admin')?'/admin-dashboard':user!==null&&user!==void 0&&(_user$roles2=user.roles)!==null&&_user$roles2!==void 0&&_user$roles2.includes('doctor')?'/doctor-dashboard':user!==null&&user!==void 0&&(_user$roles3=user.roles)!==null&&_user$roles3!==void 0&&_user$roles3.includes('nurse')?'/nurse-dashboard':'/patient-dashboard',replace:true}):/*#__PURE__*/_jsx(AuthPage,{onLogin:handleLogin,onRegister:handleRegister,isLoading:isLoading,error:error,clearError:clearError})}),/*#__PURE__*/_jsx(Route,{path:\"/patient-dashboard\",element:/*#__PURE__*/_jsx(ProtectedRoute,{allowedRoles:['patient'],children:/*#__PURE__*/_jsx(DashboardWrapper,{user:user,children:props=>/*#__PURE__*/_jsx(PatientDashboard,_objectSpread(_objectSpread({},props),{},{onLogout:handleLogout}))})})}),/*#__PURE__*/_jsx(Route,{path:\"/doctor-dashboard\",element:/*#__PURE__*/_jsx(ProtectedRoute,{allowedRoles:['doctor'],children:/*#__PURE__*/_jsx(DoctorDashboardWrapper,{user:user,children:props=>/*#__PURE__*/_jsx(DoctorDashboard,_objectSpread(_objectSpread({},props),{},{onLogout:handleLogout}))})})}),/*#__PURE__*/_jsx(Route,{path:\"/admin-dashboard\",element:/*#__PURE__*/_jsx(ProtectedRoute,{allowedRoles:['admin'],children:/*#__PURE__*/_jsx(AdminDashboardWrapper,{user:user,children:props=>/*#__PURE__*/_jsx(AdminDashboard,_objectSpread(_objectSpread({},props),{},{onLogout:handleLogout}))})})}),/*#__PURE__*/_jsx(Route,{path:\"/nurse-dashboard\",element:/*#__PURE__*/_jsx(ProtectedRoute,{allowedRoles:['nurse'],children:/*#__PURE__*/_jsx(NurseDashboardWrapper,{user:user,children:props=>/*#__PURE__*/_jsx(NurseDashboard,_objectSpread(_objectSpread({},props),{},{onLogout:handleLogout}))})})}),/*#__PURE__*/_jsx(Route,{path:\"/unauthorized\",element:/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-foreground mb-4\",children:\"Unauthorized\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted-foreground mb-4\",children:\"You don't have permission to access this page.\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,className:\"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90\",children:\"Sign Out\"})]})})}),/*#__PURE__*/_jsx(Route,{path:\"*\",element:/*#__PURE__*/_jsx(Navigate,{to:\"/\",replace:true})})]});};// Main App component\nconst App=()=>{return/*#__PURE__*/_jsx(AuthProvider,{children:/*#__PURE__*/_jsx(Router,{future:{v7_startTransition:true,v7_relativeSplatPath:true},children:/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:/*#__PURE__*/_jsx(AppRoutes,{})})})});};export default App;","map":{"version":3,"names":["React","BrowserRouter","Router","Routes","Route","Navigate","AuthProvider","useAuth","LandingPage","AuthPage","PatientDashboard","DoctorDashboard","AdminDashboard","NurseDashboard","LoadingSpinner","appointmentsAPI","servicesAPI","patientsAPI","staffAPI","adminAPI","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","ProtectedRoute","_ref","children","allowedRoles","isAuthenticated","isLoading","hasAnyRole","className","to","replace","length","DashboardWrapper","_ref2","user","appointments","setAppointments","useState","services","setServices","doctors","setDoctors","availableSlots","setAvailableSlots","patientId","setPatientId","setIsLoading","isBooking","setIsBooking","bookingError","setBookingError","loadDashboardData","patient","getByUserId","id","error","console","log","appointmentsData","servicesData","doctorsData","Promise","all","getByPatient","getAll","getByRole","name","description","durationMinutes","firstName","lastName","email","loadAvailableSlots","date","slots","getAvailable","requestedDate","Date","dayOfWeek","getDay","filteredSlots","filter","slot","handleBookAppointment","bookingData","selectedService","find","s","serviceId","startTimeFormatted","startTime","includes","split","concat","endTime","getTime","endTimeString","toTimeString","slice","create","staffId","appointmentDate","notes","_error$response","_error$response$data","response","data","message","handleUpdateAppointment","appointmentId","updateData","update","_error$response2","_error$response2$data","handleCancelAppointment","delete","_error$response3","_error$response3$data","useEffect","timer","setTimeout","clearTimeout","onBookAppointment","onUpdateAppointment","onCancelAppointment","onLoadAvailableSlots","DoctorDashboardWrapper","_ref3","patients","setPatients","shiftSchedule","setShiftSchedule","isProcessing","setIsProcessing","setError","appointmentsError","patientsData","patientsError","_error$response4","_error$response4$data","handleApproveAppointment","updateStatus","_error$response5","_error$response5$data","handleRejectAppointment","reason","_error$response6","_error$response6$data","handleUpdateShiftSchedule","shiftData","resolve","_error$response7","_error$response7$data","handleViewPatientDetails","_error$response8","_error$response8$data","onApproveAppointment","onRejectAppointment","onUpdateShiftSchedule","onViewPatientDetails","NurseDashboardWrapper","_ref4","servicesError","staffData","staff","role","staffError","_error$response9","_error$response9$data","handleBookWalkInAppointment","appointmentData","walkInAppointment","_objectSpread","toISOString","status","_error$response0","_error$response0$data","handleApproveAppointmentForDoctor","doctorId","_error$response1","_error$response1$data","_error$response10","_error$response10$dat","onBookWalkInAppointment","onApproveAppointmentForDoctor","onLogout","localStorage","removeItem","window","location","href","AdminDashboardWrapper","_ref5","users","setUsers","usersData","getUsers","_error$response11","_error$response11$dat","handleToggleUserStatus","userId","isActive","updateUserStatus","_error$response12","_error$response12$dat","handleUpdateUserRole","newRole","updateUserRole","_error$response13","_error$response13$dat","handleCreateStaff","createStaff","_error$response14","_error$response14$dat","handleCreateService","serviceData","_error$response15","_error$response15$dat","handleUpdateService","_error$response16","_error$response16$dat","handleDeleteService","appointmentsUsingService","apt","service","deleteResult","_error$response17","_error$response17$dat","_error$response18","_error$response18$dat","errorMessage","onToggleUserStatus","onUpdateUserRole","onCreateStaff","onCreateService","onUpdateService","onDeleteService","AppRoutes","_user$roles","_user$roles2","_user$roles3","login","register","logout","clearError","handleLogin","password","err","handleRegister","userData","handleLogout","path","element","roles","onLogin","onRegister","props","onClick","App","future","v7_startTransition","v7_relativeSplatPath"],"sources":["C:/Project/HopewellClinic/src/App.tsx"],"sourcesContent":["import React from 'react';\nimport { BrowserRouter as Router, Routes, Route, Navigate } from 'react-router-dom';\nimport { AuthProvider, useAuth } from './contexts/AuthContext';\nimport LandingPage from './components/LandingPage';\nimport AuthPage from './components/AuthPage';\nimport PatientDashboard from './components/PatientDashboard';\nimport DoctorDashboard from './components/DoctorDashboard';\nimport AdminDashboard from './components/AdminDashboard';\nimport NurseDashboard from './components/NurseDashboard';\nimport LoadingSpinner from './components/LoadingSpinner';\n\n// Import the existing API functions\nimport { appointmentsAPI, servicesAPI, patientsAPI, staffAPI, doctorAPI, adminAPI } from './services/api';\n\n// Protected Route component\nconst ProtectedRoute: React.FC<{ \n  children: React.ReactNode; \n  allowedRoles?: string[] \n}> = ({ children, allowedRoles = [] }) => {\n  const { isAuthenticated, isLoading, hasAnyRole } = useAuth();\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <LoadingSpinner />\n      </div>\n    );\n  }\n\n  if (!isAuthenticated) {\n    return <Navigate to=\"/auth\" replace />;\n  }\n\n  if (allowedRoles.length > 0 && !hasAnyRole(allowedRoles)) {\n    return <Navigate to=\"/unauthorized\" replace />;\n  }\n\n  return <>{children}</>;\n};\n\n// Dashboard wrapper component that handles data loading\nconst DashboardWrapper: React.FC<{ \n  children: (props: any) => React.ReactNode;\n  user: any;\n}> = ({ children, user }) => {\n  const [appointments, setAppointments] = React.useState([]);\n  const [services, setServices] = React.useState([]);\n  const [doctors, setDoctors] = React.useState([]);\n  const [availableSlots, setAvailableSlots] = React.useState([]);\n  const [patientId, setPatientId] = React.useState<string | null>(null);\n  const [isLoading, setIsLoading] = React.useState(true);\n  const [isBooking, setIsBooking] = React.useState(false);\n  const [bookingError, setBookingError] = React.useState('');\n\n  const loadDashboardData = async () => {\n    try {\n      setIsLoading(true);\n      \n      // Get the Patient ID from the ApplicationUser ID\n      try {\n        const patient = await patientsAPI.getByUserId(user.id);\n        setPatientId(patient.id);\n      } catch (error) {\n        console.log('⚠️ Patient API not available, using mock data');\n        setPatientId('mock-patient-id');\n      }\n      \n      // Try to load data, but don't fail if APIs are not available\n      try {\n        const [appointmentsData, servicesData, doctorsData] = await Promise.all([\n          appointmentsAPI.getByPatient(patientId || 'mock-patient-id'),\n          servicesAPI.getAll(),\n          staffAPI.getByRole('doctor')\n        ]);\n        setAppointments(appointmentsData);\n        setServices(servicesData);\n        setDoctors(doctorsData);\n      } catch (error) {\n        console.log('⚠️ Some APIs not available, using mock data');\n        // Set mock data instead of failing\n        setAppointments([]);\n        setServices([\n          { id: '1', name: 'General Consultation', description: 'Basic health checkup', durationMinutes: 30 } as any,\n          { id: '2', name: 'Follow-up Visit', description: 'Follow-up appointment', durationMinutes: 15 } as any\n        ]);\n        setDoctors([\n          { id: '1', firstName: 'Dr. John', lastName: 'Smith', email: 'doctor@hopewell.com' } as any,\n          { id: '2', firstName: 'Dr. Jane', lastName: 'Doe', email: 'jane@hopewell.com' } as any\n        ]);\n      }\n    } catch (error) {\n      console.error('Error loading dashboard data:', error);\n      // Set empty data instead of failing\n      setAppointments([]);\n      setServices([]);\n      setDoctors([]);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const loadAvailableSlots = async (date: string) => {\n    try {\n      console.log('Loading available slots for date:', date);\n      const slots = await appointmentsAPI.getAvailable(date);\n      console.log('Available slots received:', slots);\n      \n      // Calculate the day of the week for the requested date\n      const requestedDate = new Date(date);\n      const dayOfWeek = requestedDate.getDay(); // 0 = Sunday, 1 = Monday, etc.\n      \n      // Filter slots to only include the correct day of the week\n      const filteredSlots = slots.filter((slot: any) => slot.dayOfWeek === dayOfWeek);\n      console.log('Filtered slots for day', dayOfWeek, ':', filteredSlots);\n      \n      setAvailableSlots(filteredSlots);\n    } catch (error) {\n      console.error('Error loading available slots:', error);\n      setAvailableSlots([]);\n    }\n  };\n\n  const handleBookAppointment = async (bookingData: any) => {\n    try {\n      setIsBooking(true);\n      setBookingError('');\n      \n      // Calculate end time based on service duration\n      const selectedService = services.find((s: any) => s.id === bookingData.serviceId) as any;\n      \n      // Ensure startTime is in HH:mm:ss format\n      const startTimeFormatted = bookingData.startTime.includes(':') && bookingData.startTime.split(':').length === 2 \n        ? bookingData.startTime + ':00' \n        : bookingData.startTime;\n      \n      const startTime = new Date(`2000-01-01T${startTimeFormatted}`);\n      const endTime = new Date(startTime.getTime() + (selectedService?.durationMinutes || 30) * 60000);\n      \n      const endTimeString = endTime.toTimeString().slice(0, 8); // Format as HH:mm:ss\n      \n      await appointmentsAPI.create({\n        patientId: patientId,\n        serviceId: bookingData.serviceId,\n        staffId: bookingData.staffId,\n        appointmentDate: bookingData.appointmentDate,\n        startTime: startTimeFormatted,\n        endTime: endTimeString,\n        notes: bookingData.notes || ''\n      });\n\n      // Refresh appointments\n      await loadDashboardData();\n    } catch (error: any) {\n      console.error('Error booking appointment:', error);\n      setBookingError(error.response?.data?.error || error.message || 'Failed to book appointment');\n    } finally {\n      setIsBooking(false);\n    }\n  };\n\n  const handleUpdateAppointment = async (appointmentId: string, updateData: any) => {\n    try {\n      setIsBooking(true);\n      setBookingError('');\n      \n      // Calculate end time based on service duration\n      const selectedService = services.find((s: any) => s.id === updateData.serviceId) as any;\n      \n      // Ensure startTime is in HH:mm:ss format\n      const startTimeFormatted = updateData.startTime.includes(':') && updateData.startTime.split(':').length === 2 \n        ? updateData.startTime + ':00' \n        : updateData.startTime;\n      \n      const startTime = new Date(`2000-01-01T${startTimeFormatted}`);\n      const endTime = new Date(startTime.getTime() + (selectedService?.durationMinutes || 30) * 60000);\n      \n      const endTimeString = endTime.toTimeString().slice(0, 8); // Format as HH:mm:ss\n      \n      await appointmentsAPI.update(appointmentId, {\n        appointmentDate: updateData.appointmentDate,\n        startTime: startTimeFormatted,\n        endTime: endTimeString,\n        notes: updateData.notes || ''\n      });\n\n      // Refresh appointments\n      await loadDashboardData();\n    } catch (error: any) {\n      console.error('Error updating appointment:', error);\n      setBookingError(error.response?.data?.error || error.message || 'Failed to update appointment');\n    } finally {\n      setIsBooking(false);\n    }\n  };\n\n  const handleCancelAppointment = async (appointmentId: string) => {\n    try {\n      setIsBooking(true);\n      setBookingError('');\n      \n      await appointmentsAPI.delete(appointmentId);\n\n      // Refresh appointments\n      await loadDashboardData();\n    } catch (error: any) {\n      console.error('Error canceling appointment:', error);\n      setBookingError(error.response?.data?.error || error.message || 'Failed to cancel appointment');\n    } finally {\n      setIsBooking(false);\n    }\n  };\n\n  React.useEffect(() => {\n    // Add a small delay to ensure user is fully logged in before making API calls\n    const timer = setTimeout(() => {\n      loadDashboardData();\n    }, 100);\n    \n    return () => clearTimeout(timer);\n  }, [user.id]);\n\n  // Call children as a function with props\n  return children({\n    user,\n    appointments,\n    services,\n    doctors,\n    availableSlots,\n    isLoading,\n    isBooking,\n    bookingError,\n    onBookAppointment: handleBookAppointment,\n    onUpdateAppointment: handleUpdateAppointment,\n    onCancelAppointment: handleCancelAppointment,\n    onLoadAvailableSlots: loadAvailableSlots\n  });\n};\n\n// Doctor Dashboard wrapper component that handles doctor-specific data loading\nconst DoctorDashboardWrapper: React.FC<{ \n  children: (props: any) => React.ReactNode;\n  user: any;\n}> = ({ children, user }) => {\n  const [appointments, setAppointments] = React.useState<any[]>([]);\n  const [patients, setPatients] = React.useState<any[]>([]);\n  const [shiftSchedule, setShiftSchedule] = React.useState<any[]>([]);\n  const [isLoading, setIsLoading] = React.useState(true);\n  const [isProcessing, setIsProcessing] = React.useState(false);\n  const [error, setError] = React.useState('');\n\n  const loadDashboardData = async () => {\n    try {\n      setIsLoading(true);\n      setError('');\n\n      // For now, use existing endpoints that work\n      // Get all appointments (we'll filter by doctor later when backend supports it)\n      try {\n        const appointmentsData = await appointmentsAPI.getAll();\n        // Filter appointments for this doctor (when staffId is available)\n        setAppointments(appointmentsData);\n      } catch (appointmentsError) {\n        console.log('No appointments endpoint available yet');\n        setAppointments([]);\n      }\n\n      // Get all patients (we'll filter by doctor later when backend supports it)\n      try {\n        const patientsData = await patientsAPI.getAll();\n        setPatients(patientsData);\n      } catch (patientsError) {\n        console.log('No patients endpoint available yet');\n        setPatients([]);\n      }\n\n      // Initialize empty shift schedule (backend not implemented yet)\n      setShiftSchedule([]);\n    } catch (error: any) {\n      console.error('Error loading doctor dashboard data:', error);\n      setError(error.response?.data?.error || error.message || 'Failed to load dashboard data');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleApproveAppointment = async (appointmentId: string) => {\n    try {\n      setIsProcessing(true);\n      setError('');\n      // For now, just update the appointment status using existing endpoint\n      await appointmentsAPI.updateStatus(appointmentId, 'confirmed');\n      await loadDashboardData(); // Refresh data\n    } catch (error: any) {\n      console.error('Error approving appointment:', error);\n      setError(error.response?.data?.error || error.message || 'Failed to approve appointment');\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const handleRejectAppointment = async (appointmentId: string, reason: string) => {\n    try {\n      setIsProcessing(true);\n      setError('');\n      // For now, just update the appointment status using existing endpoint\n      await appointmentsAPI.updateStatus(appointmentId, 'cancelled');\n      await loadDashboardData(); // Refresh data\n    } catch (error: any) {\n      console.error('Error rejecting appointment:', error);\n      setError(error.response?.data?.error || error.message || 'Failed to reject appointment');\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const handleUpdateShiftSchedule = async (shiftData: any[]) => {\n    try {\n      setIsProcessing(true);\n      setError('');\n      // For now, just store locally (backend not implemented yet)\n      console.log('Shift schedule update requested:', shiftData);\n      setShiftSchedule(shiftData);\n      // Simulate success\n      await new Promise(resolve => setTimeout(resolve, 1000));\n    } catch (error: any) {\n      console.error('Error updating shift schedule:', error);\n      setError(error.response?.data?.error || error.message || 'Failed to update shift schedule');\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const handleViewPatientDetails = async (patientId: string) => {\n    try {\n      setError('');\n      // For now, just log the request (backend not implemented yet)\n      console.log('View patient details requested for:', patientId);\n    } catch (error: any) {\n      console.error('Error loading patient details:', error);\n      setError(error.response?.data?.error || error.message || 'Failed to load patient details');\n    }\n  };\n\n  React.useEffect(() => {\n    // Add a small delay to ensure user is fully logged in before making API calls\n    const timer = setTimeout(() => {\n      loadDashboardData();\n    }, 100);\n    \n    return () => clearTimeout(timer);\n  }, [user.id]);\n\n  // Call children as a function with props\n  return children({\n    user,\n    appointments,\n    patients,\n    shiftSchedule,\n    isLoading,\n    isProcessing,\n    error,\n    onApproveAppointment: handleApproveAppointment,\n    onRejectAppointment: handleRejectAppointment,\n    onUpdateShiftSchedule: handleUpdateShiftSchedule,\n    onViewPatientDetails: handleViewPatientDetails\n  });\n};\n\n// Nurse Dashboard wrapper component that handles nurse-specific data loading\nconst NurseDashboardWrapper: React.FC<{ \n  children: (props: any) => React.ReactNode;\n  user: any;\n}> = ({ children, user }) => {\n  const [appointments, setAppointments] = React.useState<any[]>([]);\n  const [services, setServices] = React.useState<any[]>([]);\n  const [doctors, setDoctors] = React.useState<any[]>([]);\n  const [isLoading, setIsLoading] = React.useState(true);\n  const [isProcessing, setIsProcessing] = React.useState(false);\n  const [error, setError] = React.useState('');\n\n  const loadDashboardData = async () => {\n    try {\n      setIsLoading(true);\n      setError('');\n\n      // Load appointments\n      try {\n        const appointmentsData = await appointmentsAPI.getAll();\n        setAppointments(appointmentsData);\n      } catch (appointmentsError) {\n        console.log('No appointments endpoint available yet');\n        setAppointments([]);\n      }\n\n      // Load services\n      try {\n        const servicesData = await servicesAPI.getAll();\n        setServices(servicesData);\n      } catch (servicesError) {\n        console.log('No services endpoint available yet');\n        setServices([]);\n      }\n\n      // Load doctors (staff with doctor role)\n      try {\n        const staffData = await staffAPI.getAll();\n        const doctorsData = staffData.filter((staff: any) => staff.role === 'doctor');\n        setDoctors(doctorsData);\n      } catch (staffError) {\n        console.log('No staff endpoint available yet');\n        setDoctors([]);\n      }\n    } catch (error: any) {\n      console.error('Error loading nurse dashboard data:', error);\n      setError(error.response?.data?.error || error.message || 'Failed to load dashboard data');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  React.useEffect(() => {\n    loadDashboardData();\n  }, []);\n\n  const handleBookWalkInAppointment = async (appointmentData: any) => {\n    try {\n      setIsProcessing(true);\n      setError('');\n      \n      // Create a walk-in appointment with immediate scheduling\n      const walkInAppointment = {\n        ...appointmentData,\n        appointmentDate: new Date().toISOString().split('T')[0], // Today\n        startTime: new Date().toTimeString().slice(0, 5), // Current time\n        status: 'walkin',\n        notes: `Walk-in appointment: ${appointmentData.notes || 'No additional notes'}`\n      };\n\n      await appointmentsAPI.create(walkInAppointment);\n      await loadDashboardData(); // Refresh data\n    } catch (error: any) {\n      console.error('Error booking walk-in appointment:', error);\n      setError(error.response?.data?.error || error.message || 'Failed to book walk-in appointment');\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const handleApproveAppointmentForDoctor = async (appointmentId: string, doctorId: string) => {\n    try {\n      setIsProcessing(true);\n      setError('');\n      \n      // Update appointment with doctor assignment and approval\n      await appointmentsAPI.update(appointmentId, {\n        staffId: doctorId,\n        status: 'confirmed'\n      });\n      \n      await loadDashboardData(); // Refresh data\n    } catch (error: any) {\n      console.error('Error approving appointment for doctor:', error);\n      setError(error.response?.data?.error || error.message || 'Failed to approve appointment');\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const handleRejectAppointment = async (appointmentId: string, reason: string) => {\n    try {\n      setIsProcessing(true);\n      setError('');\n      \n      await appointmentsAPI.update(appointmentId, {\n        status: 'cancelled',\n        notes: `Rejected by nurse: ${reason}`\n      });\n      \n      await loadDashboardData(); // Refresh data\n    } catch (error: any) {\n      console.error('Error rejecting appointment:', error);\n      setError(error.response?.data?.error || error.message || 'Failed to reject appointment');\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  return children({\n    user,\n    appointments,\n    services,\n    doctors,\n    isLoading,\n    isProcessing,\n    error,\n    onBookWalkInAppointment: handleBookWalkInAppointment,\n    onApproveAppointmentForDoctor: handleApproveAppointmentForDoctor,\n    onRejectAppointment: handleRejectAppointment,\n    onLogout: () => {\n      localStorage.removeItem('token');\n      window.location.href = '/auth';\n    }\n  });\n};\n\n// Admin Dashboard wrapper component that handles admin-specific data loading\nconst AdminDashboardWrapper: React.FC<{ \n  children: (props: any) => React.ReactNode;\n  user: any;\n}> = ({ children, user }) => {\n  const [users, setUsers] = React.useState<any[]>([]);\n  const [appointments, setAppointments] = React.useState<any[]>([]);\n  const [services, setServices] = React.useState<any[]>([]);\n  const [isLoading, setIsLoading] = React.useState(true);\n  const [isProcessing, setIsProcessing] = React.useState(false);\n  const [error, setError] = React.useState('');\n\n  const loadDashboardData = async () => {\n    try {\n      setIsLoading(true);\n      setError('');\n\n      // Get all staff members\n      try {\n        const staffData = await staffAPI.getAll();\n        console.log('Staff data received:', staffData);\n        setUsers(staffData);\n      } catch (staffError) {\n        console.log('No staff endpoint available, falling back to users');\n        const usersData = await adminAPI.getUsers();\n        console.log('Users data received:', usersData);\n        setUsers(usersData);\n      }\n\n      // Get all appointments (we'll need to implement this endpoint)\n      try {\n        // For now, we'll use the existing appointments API\n        const appointmentsData = await appointmentsAPI.getAll();\n        setAppointments(appointmentsData);\n      } catch (appointmentsError) {\n        console.log('No appointments endpoint available yet');\n        setAppointments([]);\n      }\n\n      // Load services\n      try {\n        const servicesData = await servicesAPI.getAll();\n        setServices(servicesData);\n      } catch (servicesError) {\n        console.log('No services endpoint available yet');\n        setServices([]);\n      }\n    } catch (error: any) {\n      console.error('Error loading admin dashboard data:', error);\n      setError(error.response?.data?.error || error.message || 'Failed to load dashboard data');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleToggleUserStatus = async (userId: string, isActive: boolean) => {\n    try {\n      setIsProcessing(true);\n      setError('');\n      await adminAPI.updateUserStatus(userId, isActive);\n      await loadDashboardData(); // Refresh data\n    } catch (error: any) {\n      console.error('Error updating user status:', error);\n      setError(error.response?.data?.error || error.message || 'Failed to update user status');\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const handleUpdateUserRole = async (userId: string, newRole: string) => {\n    try {\n      setIsProcessing(true);\n      setError('');\n      await adminAPI.updateUserRole(userId, newRole);\n      await loadDashboardData(); // Refresh data\n    } catch (error: any) {\n      console.error('Error updating user role:', error);\n      setError(error.response?.data?.error || error.message || 'Failed to update user role');\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const handleCreateStaff = async (staffData: any) => {\n    try {\n      setIsProcessing(true);\n      setError('');\n      await adminAPI.createStaff(staffData);\n      await loadDashboardData(); // Refresh data\n    } catch (error: any) {\n      console.error('Error creating staff:', error);\n      setError(error.response?.data?.error || error.message || 'Failed to create staff member');\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const handleCreateService = async (serviceData: any) => {\n    try {\n      setIsProcessing(true);\n      setError('');\n      await servicesAPI.create(serviceData);\n      await loadDashboardData(); // Refresh data\n    } catch (error: any) {\n      console.error('Error creating service:', error);\n      setError(error.response?.data?.error || error.message || 'Failed to create service');\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const handleUpdateService = async (serviceId: string, serviceData: any) => {\n    try {\n      setIsProcessing(true);\n      setError('');\n      await servicesAPI.update(serviceId, serviceData);\n      await loadDashboardData(); // Refresh data\n    } catch (error: any) {\n      console.error('Error updating service:', error);\n      setError(error.response?.data?.error || error.message || 'Failed to update service');\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const handleDeleteService = async (serviceId: string) => {\n    try {\n      setIsProcessing(true);\n      setError('');\n      \n      // Check if service is being used by any appointments\n      const appointmentsUsingService = appointments.filter(apt => apt.service.id === serviceId);\n      if (appointmentsUsingService.length > 0) {\n        setError(`Cannot delete service. It is currently being used by ${appointmentsUsingService.length} appointment(s). Please cancel or reschedule these appointments first.`);\n        return;\n      }\n      \n      console.log('Attempting to delete service:', serviceId);\n      const deleteResult = await servicesAPI.delete(serviceId);\n      console.log('Delete result:', deleteResult);\n      await loadDashboardData(); // Refresh data\n    } catch (error: any) {\n      console.error('Error deleting service:', error);\n      \n      // Provide more specific error messages\n      let errorMessage = 'Failed to delete service';\n      if (error.response?.data?.error) {\n        errorMessage = error.response.data.error;\n      } else if (error.response?.data?.message) {\n        errorMessage = error.response.data.message;\n      } else if (error.message) {\n        errorMessage = error.message;\n      }\n      \n      // Check for common database constraint errors\n      if (errorMessage.includes('foreign key') || errorMessage.includes('constraint') || errorMessage.includes('reference')) {\n        errorMessage = 'Cannot delete service. It is currently being used by existing appointments. Please cancel or reschedule these appointments first.';\n      }\n      \n      setError(errorMessage);\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  React.useEffect(() => {\n    loadDashboardData();\n  }, [user.id]);\n\n  // Call children as a function with props\n  return children({\n    user,\n    users,\n    appointments,\n    services,\n    isLoading,\n    isProcessing,\n    error,\n    onToggleUserStatus: handleToggleUserStatus,\n    onUpdateUserRole: handleUpdateUserRole,\n    onCreateStaff: handleCreateStaff,\n    onCreateService: handleCreateService,\n    onUpdateService: handleUpdateService,\n    onDeleteService: handleDeleteService,\n    onLogout: () => {\n      localStorage.removeItem('token');\n      window.location.href = '/auth';\n    }\n  });\n};\n\n// Main App Routes component\nconst AppRoutes: React.FC = () => {\n  const { isAuthenticated, user, login, register, logout, isLoading, error, clearError } = useAuth();\n\n  const handleLogin = async (email: string, password: string) => {\n    try {\n      await login({ email, password });\n    } catch (err) {\n      // Error is handled by AuthContext\n    }\n  };\n\n  const handleRegister = async (userData: any) => {\n    try {\n      await register(userData);\n    } catch (err) {\n      // Error is handled by AuthContext\n    }\n  };\n\n  const handleLogout = () => {\n    logout();\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <LoadingSpinner />\n      </div>\n    );\n  }\n\n  return (\n    <Routes>\n      {/* Public Routes */}\n      <Route path=\"/\" element={<LandingPage />} />\n      <Route \n        path=\"/auth\" \n        element={\n          isAuthenticated ? (\n            <Navigate to={\n              user?.roles?.includes('admin') ? '/admin-dashboard' :\n              user?.roles?.includes('doctor') ? '/doctor-dashboard' :\n              user?.roles?.includes('nurse') ? '/nurse-dashboard' :\n              '/patient-dashboard'\n            } replace />\n          ) : (\n            <AuthPage\n              onLogin={handleLogin}\n              onRegister={handleRegister}\n              isLoading={isLoading}\n              error={error}\n              clearError={clearError}\n            />\n          )\n        } \n      />\n\n      {/* Protected Routes */}\n      <Route\n        path=\"/patient-dashboard\"\n        element={\n          <ProtectedRoute allowedRoles={['patient']}>\n            <DashboardWrapper user={user}>\n              {(props) => <PatientDashboard {...props} onLogout={handleLogout} />}\n            </DashboardWrapper>\n          </ProtectedRoute>\n        }\n      />\n\n      <Route\n        path=\"/doctor-dashboard\"\n        element={\n          <ProtectedRoute allowedRoles={['doctor']}>\n            <DoctorDashboardWrapper user={user}>\n              {(props) => <DoctorDashboard {...props} onLogout={handleLogout} />}\n            </DoctorDashboardWrapper>\n          </ProtectedRoute>\n        }\n      />\n\n      <Route\n        path=\"/admin-dashboard\"\n        element={\n          <ProtectedRoute allowedRoles={['admin']}>\n            <AdminDashboardWrapper user={user}>\n              {(props) => <AdminDashboard {...props} onLogout={handleLogout} />}\n            </AdminDashboardWrapper>\n          </ProtectedRoute>\n        }\n      />\n\n      <Route\n        path=\"/nurse-dashboard\"\n        element={\n          <ProtectedRoute allowedRoles={['nurse']}>\n            <NurseDashboardWrapper user={user}>\n              {(props) => <NurseDashboard {...props} onLogout={handleLogout} />}\n            </NurseDashboardWrapper>\n          </ProtectedRoute>\n        }\n      />\n\n      {/* Fallback Routes */}\n      <Route path=\"/unauthorized\" element={\n        <div className=\"min-h-screen flex items-center justify-center\">\n          <div className=\"text-center\">\n            <h1 className=\"text-2xl font-bold text-foreground mb-4\">Unauthorized</h1>\n            <p className=\"text-muted-foreground mb-4\">You don't have permission to access this page.</p>\n            <button \n              onClick={handleLogout}\n              className=\"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90\"\n            >\n              Sign Out\n            </button>\n          </div>\n        </div>\n      } />\n      \n      <Route path=\"*\" element={<Navigate to=\"/\" replace />} />\n    </Routes>\n  );\n};\n\n// Main App component\nconst App: React.FC = () => {\n  return (\n    <AuthProvider>\n      <Router future={{ v7_startTransition: true, v7_relativeSplatPath: true }}>\n        <div className=\"App\">\n          <AppRoutes />\n        </div>\n      </Router>\n    </AuthProvider>\n  );\n};\n\nexport default App;\n"],"mappings":"8GAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CACzB,OAASC,aAAa,GAAI,CAAAC,MAAM,CAAEC,MAAM,CAAEC,KAAK,CAAEC,QAAQ,KAAQ,kBAAkB,CACnF,OAASC,YAAY,CAAEC,OAAO,KAAQ,wBAAwB,CAC9D,MAAO,CAAAC,WAAW,KAAM,0BAA0B,CAClD,MAAO,CAAAC,QAAQ,KAAM,uBAAuB,CAC5C,MAAO,CAAAC,gBAAgB,KAAM,+BAA+B,CAC5D,MAAO,CAAAC,eAAe,KAAM,8BAA8B,CAC1D,MAAO,CAAAC,cAAc,KAAM,6BAA6B,CACxD,MAAO,CAAAC,cAAc,KAAM,6BAA6B,CACxD,MAAO,CAAAC,cAAc,KAAM,6BAA6B,CAExD;AACA,OAASC,eAAe,CAAEC,WAAW,CAAEC,WAAW,CAAEC,QAAQ,CAAaC,QAAQ,KAAQ,gBAAgB,CAEzG;AAAA,OAAAC,GAAA,IAAAC,IAAA,CAAAC,QAAA,IAAAC,SAAA,CAAAC,IAAA,IAAAC,KAAA,yBACA,KAAM,CAAAC,cAGJ,CAAGC,IAAA,EAAqC,IAApC,CAAEC,QAAQ,CAAEC,YAAY,CAAG,EAAG,CAAC,CAAAF,IAAA,CACnC,KAAM,CAAEG,eAAe,CAAEC,SAAS,CAAEC,UAAW,CAAC,CAAGzB,OAAO,CAAC,CAAC,CAE5D,GAAIwB,SAAS,CAAE,CACb,mBACEV,IAAA,QAAKY,SAAS,CAAC,+CAA+C,CAAAL,QAAA,cAC5DP,IAAA,CAACP,cAAc,GAAE,CAAC,CACf,CAAC,CAEV,CAEA,GAAI,CAACgB,eAAe,CAAE,CACpB,mBAAOT,IAAA,CAAChB,QAAQ,EAAC6B,EAAE,CAAC,OAAO,CAACC,OAAO,MAAE,CAAC,CACxC,CAEA,GAAIN,YAAY,CAACO,MAAM,CAAG,CAAC,EAAI,CAACJ,UAAU,CAACH,YAAY,CAAC,CAAE,CACxD,mBAAOR,IAAA,CAAChB,QAAQ,EAAC6B,EAAE,CAAC,eAAe,CAACC,OAAO,MAAE,CAAC,CAChD,CAEA,mBAAOd,IAAA,CAAAE,SAAA,EAAAK,QAAA,CAAGA,QAAQ,CAAG,CAAC,CACxB,CAAC,CAED;AACA,KAAM,CAAAS,gBAGJ,CAAGC,KAAA,EAAwB,IAAvB,CAAEV,QAAQ,CAAEW,IAAK,CAAC,CAAAD,KAAA,CACtB,KAAM,CAACE,YAAY,CAAEC,eAAe,CAAC,CAAGzC,KAAK,CAAC0C,QAAQ,CAAC,EAAE,CAAC,CAC1D,KAAM,CAACC,QAAQ,CAAEC,WAAW,CAAC,CAAG5C,KAAK,CAAC0C,QAAQ,CAAC,EAAE,CAAC,CAClD,KAAM,CAACG,OAAO,CAAEC,UAAU,CAAC,CAAG9C,KAAK,CAAC0C,QAAQ,CAAC,EAAE,CAAC,CAChD,KAAM,CAACK,cAAc,CAAEC,iBAAiB,CAAC,CAAGhD,KAAK,CAAC0C,QAAQ,CAAC,EAAE,CAAC,CAC9D,KAAM,CAACO,SAAS,CAAEC,YAAY,CAAC,CAAGlD,KAAK,CAAC0C,QAAQ,CAAgB,IAAI,CAAC,CACrE,KAAM,CAACX,SAAS,CAAEoB,YAAY,CAAC,CAAGnD,KAAK,CAAC0C,QAAQ,CAAC,IAAI,CAAC,CACtD,KAAM,CAACU,SAAS,CAAEC,YAAY,CAAC,CAAGrD,KAAK,CAAC0C,QAAQ,CAAC,KAAK,CAAC,CACvD,KAAM,CAACY,YAAY,CAAEC,eAAe,CAAC,CAAGvD,KAAK,CAAC0C,QAAQ,CAAC,EAAE,CAAC,CAE1D,KAAM,CAAAc,iBAAiB,CAAG,KAAAA,CAAA,GAAY,CACpC,GAAI,CACFL,YAAY,CAAC,IAAI,CAAC,CAElB;AACA,GAAI,CACF,KAAM,CAAAM,OAAO,CAAG,KAAM,CAAAxC,WAAW,CAACyC,WAAW,CAACnB,IAAI,CAACoB,EAAE,CAAC,CACtDT,YAAY,CAACO,OAAO,CAACE,EAAE,CAAC,CAC1B,CAAE,MAAOC,KAAK,CAAE,CACdC,OAAO,CAACC,GAAG,CAAC,+CAA+C,CAAC,CAC5DZ,YAAY,CAAC,iBAAiB,CAAC,CACjC,CAEA;AACA,GAAI,CACF,KAAM,CAACa,gBAAgB,CAAEC,YAAY,CAAEC,WAAW,CAAC,CAAG,KAAM,CAAAC,OAAO,CAACC,GAAG,CAAC,CACtEpD,eAAe,CAACqD,YAAY,CAACnB,SAAS,EAAI,iBAAiB,CAAC,CAC5DjC,WAAW,CAACqD,MAAM,CAAC,CAAC,CACpBnD,QAAQ,CAACoD,SAAS,CAAC,QAAQ,CAAC,CAC7B,CAAC,CACF7B,eAAe,CAACsB,gBAAgB,CAAC,CACjCnB,WAAW,CAACoB,YAAY,CAAC,CACzBlB,UAAU,CAACmB,WAAW,CAAC,CACzB,CAAE,MAAOL,KAAK,CAAE,CACdC,OAAO,CAACC,GAAG,CAAC,6CAA6C,CAAC,CAC1D;AACArB,eAAe,CAAC,EAAE,CAAC,CACnBG,WAAW,CAAC,CACV,CAAEe,EAAE,CAAE,GAAG,CAAEY,IAAI,CAAE,sBAAsB,CAAEC,WAAW,CAAE,sBAAsB,CAAEC,eAAe,CAAE,EAAG,CAAC,CACnG,CAAEd,EAAE,CAAE,GAAG,CAAEY,IAAI,CAAE,iBAAiB,CAAEC,WAAW,CAAE,uBAAuB,CAAEC,eAAe,CAAE,EAAG,CAAC,CAChG,CAAC,CACF3B,UAAU,CAAC,CACT,CAAEa,EAAE,CAAE,GAAG,CAAEe,SAAS,CAAE,UAAU,CAAEC,QAAQ,CAAE,OAAO,CAAEC,KAAK,CAAE,qBAAsB,CAAC,CACnF,CAAEjB,EAAE,CAAE,GAAG,CAAEe,SAAS,CAAE,UAAU,CAAEC,QAAQ,CAAE,KAAK,CAAEC,KAAK,CAAE,mBAAoB,CAAC,CAChF,CAAC,CACJ,CACF,CAAE,MAAOhB,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,+BAA+B,CAAEA,KAAK,CAAC,CACrD;AACAnB,eAAe,CAAC,EAAE,CAAC,CACnBG,WAAW,CAAC,EAAE,CAAC,CACfE,UAAU,CAAC,EAAE,CAAC,CAChB,CAAC,OAAS,CACRK,YAAY,CAAC,KAAK,CAAC,CACrB,CACF,CAAC,CAED,KAAM,CAAA0B,kBAAkB,CAAG,KAAO,CAAAC,IAAY,EAAK,CACjD,GAAI,CACFjB,OAAO,CAACC,GAAG,CAAC,mCAAmC,CAAEgB,IAAI,CAAC,CACtD,KAAM,CAAAC,KAAK,CAAG,KAAM,CAAAhE,eAAe,CAACiE,YAAY,CAACF,IAAI,CAAC,CACtDjB,OAAO,CAACC,GAAG,CAAC,2BAA2B,CAAEiB,KAAK,CAAC,CAE/C;AACA,KAAM,CAAAE,aAAa,CAAG,GAAI,CAAAC,IAAI,CAACJ,IAAI,CAAC,CACpC,KAAM,CAAAK,SAAS,CAAGF,aAAa,CAACG,MAAM,CAAC,CAAC,CAAE;AAE1C;AACA,KAAM,CAAAC,aAAa,CAAGN,KAAK,CAACO,MAAM,CAAEC,IAAS,EAAKA,IAAI,CAACJ,SAAS,GAAKA,SAAS,CAAC,CAC/EtB,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAEqB,SAAS,CAAE,GAAG,CAAEE,aAAa,CAAC,CAEpErC,iBAAiB,CAACqC,aAAa,CAAC,CAClC,CAAE,MAAOzB,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,gCAAgC,CAAEA,KAAK,CAAC,CACtDZ,iBAAiB,CAAC,EAAE,CAAC,CACvB,CACF,CAAC,CAED,KAAM,CAAAwC,qBAAqB,CAAG,KAAO,CAAAC,WAAgB,EAAK,CACxD,GAAI,CACFpC,YAAY,CAAC,IAAI,CAAC,CAClBE,eAAe,CAAC,EAAE,CAAC,CAEnB;AACA,KAAM,CAAAmC,eAAe,CAAG/C,QAAQ,CAACgD,IAAI,CAAEC,CAAM,EAAKA,CAAC,CAACjC,EAAE,GAAK8B,WAAW,CAACI,SAAS,CAAQ,CAExF;AACA,KAAM,CAAAC,kBAAkB,CAAGL,WAAW,CAACM,SAAS,CAACC,QAAQ,CAAC,GAAG,CAAC,EAAIP,WAAW,CAACM,SAAS,CAACE,KAAK,CAAC,GAAG,CAAC,CAAC7D,MAAM,GAAK,CAAC,CAC3GqD,WAAW,CAACM,SAAS,CAAG,KAAK,CAC7BN,WAAW,CAACM,SAAS,CAEzB,KAAM,CAAAA,SAAS,CAAG,GAAI,CAAAb,IAAI,eAAAgB,MAAA,CAAeJ,kBAAkB,CAAE,CAAC,CAC9D,KAAM,CAAAK,OAAO,CAAG,GAAI,CAAAjB,IAAI,CAACa,SAAS,CAACK,OAAO,CAAC,CAAC,CAAG,CAAC,CAAAV,eAAe,SAAfA,eAAe,iBAAfA,eAAe,CAAEjB,eAAe,GAAI,EAAE,EAAI,KAAK,CAAC,CAEhG,KAAM,CAAA4B,aAAa,CAAGF,OAAO,CAACG,YAAY,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC,CAAE;AAE1D,KAAM,CAAAxF,eAAe,CAACyF,MAAM,CAAC,CAC3BvD,SAAS,CAAEA,SAAS,CACpB4C,SAAS,CAAEJ,WAAW,CAACI,SAAS,CAChCY,OAAO,CAAEhB,WAAW,CAACgB,OAAO,CAC5BC,eAAe,CAAEjB,WAAW,CAACiB,eAAe,CAC5CX,SAAS,CAAED,kBAAkB,CAC7BK,OAAO,CAAEE,aAAa,CACtBM,KAAK,CAAElB,WAAW,CAACkB,KAAK,EAAI,EAC9B,CAAC,CAAC,CAEF;AACA,KAAM,CAAAnD,iBAAiB,CAAC,CAAC,CAC3B,CAAE,MAAOI,KAAU,CAAE,KAAAgD,eAAA,CAAAC,oBAAA,CACnBhD,OAAO,CAACD,KAAK,CAAC,4BAA4B,CAAEA,KAAK,CAAC,CAClDL,eAAe,CAAC,EAAAqD,eAAA,CAAAhD,KAAK,CAACkD,QAAQ,UAAAF,eAAA,kBAAAC,oBAAA,CAAdD,eAAA,CAAgBG,IAAI,UAAAF,oBAAA,iBAApBA,oBAAA,CAAsBjD,KAAK,GAAIA,KAAK,CAACoD,OAAO,EAAI,4BAA4B,CAAC,CAC/F,CAAC,OAAS,CACR3D,YAAY,CAAC,KAAK,CAAC,CACrB,CACF,CAAC,CAED,KAAM,CAAA4D,uBAAuB,CAAG,KAAAA,CAAOC,aAAqB,CAAEC,UAAe,GAAK,CAChF,GAAI,CACF9D,YAAY,CAAC,IAAI,CAAC,CAClBE,eAAe,CAAC,EAAE,CAAC,CAEnB;AACA,KAAM,CAAAmC,eAAe,CAAG/C,QAAQ,CAACgD,IAAI,CAAEC,CAAM,EAAKA,CAAC,CAACjC,EAAE,GAAKwD,UAAU,CAACtB,SAAS,CAAQ,CAEvF;AACA,KAAM,CAAAC,kBAAkB,CAAGqB,UAAU,CAACpB,SAAS,CAACC,QAAQ,CAAC,GAAG,CAAC,EAAImB,UAAU,CAACpB,SAAS,CAACE,KAAK,CAAC,GAAG,CAAC,CAAC7D,MAAM,GAAK,CAAC,CACzG+E,UAAU,CAACpB,SAAS,CAAG,KAAK,CAC5BoB,UAAU,CAACpB,SAAS,CAExB,KAAM,CAAAA,SAAS,CAAG,GAAI,CAAAb,IAAI,eAAAgB,MAAA,CAAeJ,kBAAkB,CAAE,CAAC,CAC9D,KAAM,CAAAK,OAAO,CAAG,GAAI,CAAAjB,IAAI,CAACa,SAAS,CAACK,OAAO,CAAC,CAAC,CAAG,CAAC,CAAAV,eAAe,SAAfA,eAAe,iBAAfA,eAAe,CAAEjB,eAAe,GAAI,EAAE,EAAI,KAAK,CAAC,CAEhG,KAAM,CAAA4B,aAAa,CAAGF,OAAO,CAACG,YAAY,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC,CAAE;AAE1D,KAAM,CAAAxF,eAAe,CAACqG,MAAM,CAACF,aAAa,CAAE,CAC1CR,eAAe,CAAES,UAAU,CAACT,eAAe,CAC3CX,SAAS,CAAED,kBAAkB,CAC7BK,OAAO,CAAEE,aAAa,CACtBM,KAAK,CAAEQ,UAAU,CAACR,KAAK,EAAI,EAC7B,CAAC,CAAC,CAEF;AACA,KAAM,CAAAnD,iBAAiB,CAAC,CAAC,CAC3B,CAAE,MAAOI,KAAU,CAAE,KAAAyD,gBAAA,CAAAC,qBAAA,CACnBzD,OAAO,CAACD,KAAK,CAAC,6BAA6B,CAAEA,KAAK,CAAC,CACnDL,eAAe,CAAC,EAAA8D,gBAAA,CAAAzD,KAAK,CAACkD,QAAQ,UAAAO,gBAAA,kBAAAC,qBAAA,CAAdD,gBAAA,CAAgBN,IAAI,UAAAO,qBAAA,iBAApBA,qBAAA,CAAsB1D,KAAK,GAAIA,KAAK,CAACoD,OAAO,EAAI,8BAA8B,CAAC,CACjG,CAAC,OAAS,CACR3D,YAAY,CAAC,KAAK,CAAC,CACrB,CACF,CAAC,CAED,KAAM,CAAAkE,uBAAuB,CAAG,KAAO,CAAAL,aAAqB,EAAK,CAC/D,GAAI,CACF7D,YAAY,CAAC,IAAI,CAAC,CAClBE,eAAe,CAAC,EAAE,CAAC,CAEnB,KAAM,CAAAxC,eAAe,CAACyG,MAAM,CAACN,aAAa,CAAC,CAE3C;AACA,KAAM,CAAA1D,iBAAiB,CAAC,CAAC,CAC3B,CAAE,MAAOI,KAAU,CAAE,KAAA6D,gBAAA,CAAAC,qBAAA,CACnB7D,OAAO,CAACD,KAAK,CAAC,8BAA8B,CAAEA,KAAK,CAAC,CACpDL,eAAe,CAAC,EAAAkE,gBAAA,CAAA7D,KAAK,CAACkD,QAAQ,UAAAW,gBAAA,kBAAAC,qBAAA,CAAdD,gBAAA,CAAgBV,IAAI,UAAAW,qBAAA,iBAApBA,qBAAA,CAAsB9D,KAAK,GAAIA,KAAK,CAACoD,OAAO,EAAI,8BAA8B,CAAC,CACjG,CAAC,OAAS,CACR3D,YAAY,CAAC,KAAK,CAAC,CACrB,CACF,CAAC,CAEDrD,KAAK,CAAC2H,SAAS,CAAC,IAAM,CACpB;AACA,KAAM,CAAAC,KAAK,CAAGC,UAAU,CAAC,IAAM,CAC7BrE,iBAAiB,CAAC,CAAC,CACrB,CAAC,CAAE,GAAG,CAAC,CAEP,MAAO,IAAMsE,YAAY,CAACF,KAAK,CAAC,CAClC,CAAC,CAAE,CAACrF,IAAI,CAACoB,EAAE,CAAC,CAAC,CAEb;AACA,MAAO,CAAA/B,QAAQ,CAAC,CACdW,IAAI,CACJC,YAAY,CACZG,QAAQ,CACRE,OAAO,CACPE,cAAc,CACdhB,SAAS,CACTqB,SAAS,CACTE,YAAY,CACZyE,iBAAiB,CAAEvC,qBAAqB,CACxCwC,mBAAmB,CAAEf,uBAAuB,CAC5CgB,mBAAmB,CAAEV,uBAAuB,CAC5CW,oBAAoB,CAAErD,kBACxB,CAAC,CAAC,CACJ,CAAC,CAED;AACA,KAAM,CAAAsD,sBAGJ,CAAGC,KAAA,EAAwB,IAAvB,CAAExG,QAAQ,CAAEW,IAAK,CAAC,CAAA6F,KAAA,CACtB,KAAM,CAAC5F,YAAY,CAAEC,eAAe,CAAC,CAAGzC,KAAK,CAAC0C,QAAQ,CAAQ,EAAE,CAAC,CACjE,KAAM,CAAC2F,QAAQ,CAAEC,WAAW,CAAC,CAAGtI,KAAK,CAAC0C,QAAQ,CAAQ,EAAE,CAAC,CACzD,KAAM,CAAC6F,aAAa,CAAEC,gBAAgB,CAAC,CAAGxI,KAAK,CAAC0C,QAAQ,CAAQ,EAAE,CAAC,CACnE,KAAM,CAACX,SAAS,CAAEoB,YAAY,CAAC,CAAGnD,KAAK,CAAC0C,QAAQ,CAAC,IAAI,CAAC,CACtD,KAAM,CAAC+F,YAAY,CAAEC,eAAe,CAAC,CAAG1I,KAAK,CAAC0C,QAAQ,CAAC,KAAK,CAAC,CAC7D,KAAM,CAACkB,KAAK,CAAE+E,QAAQ,CAAC,CAAG3I,KAAK,CAAC0C,QAAQ,CAAC,EAAE,CAAC,CAE5C,KAAM,CAAAc,iBAAiB,CAAG,KAAAA,CAAA,GAAY,CACpC,GAAI,CACFL,YAAY,CAAC,IAAI,CAAC,CAClBwF,QAAQ,CAAC,EAAE,CAAC,CAEZ;AACA;AACA,GAAI,CACF,KAAM,CAAA5E,gBAAgB,CAAG,KAAM,CAAAhD,eAAe,CAACsD,MAAM,CAAC,CAAC,CACvD;AACA5B,eAAe,CAACsB,gBAAgB,CAAC,CACnC,CAAE,MAAO6E,iBAAiB,CAAE,CAC1B/E,OAAO,CAACC,GAAG,CAAC,wCAAwC,CAAC,CACrDrB,eAAe,CAAC,EAAE,CAAC,CACrB,CAEA;AACA,GAAI,CACF,KAAM,CAAAoG,YAAY,CAAG,KAAM,CAAA5H,WAAW,CAACoD,MAAM,CAAC,CAAC,CAC/CiE,WAAW,CAACO,YAAY,CAAC,CAC3B,CAAE,MAAOC,aAAa,CAAE,CACtBjF,OAAO,CAACC,GAAG,CAAC,oCAAoC,CAAC,CACjDwE,WAAW,CAAC,EAAE,CAAC,CACjB,CAEA;AACAE,gBAAgB,CAAC,EAAE,CAAC,CACtB,CAAE,MAAO5E,KAAU,CAAE,KAAAmF,gBAAA,CAAAC,qBAAA,CACnBnF,OAAO,CAACD,KAAK,CAAC,sCAAsC,CAAEA,KAAK,CAAC,CAC5D+E,QAAQ,CAAC,EAAAI,gBAAA,CAAAnF,KAAK,CAACkD,QAAQ,UAAAiC,gBAAA,kBAAAC,qBAAA,CAAdD,gBAAA,CAAgBhC,IAAI,UAAAiC,qBAAA,iBAApBA,qBAAA,CAAsBpF,KAAK,GAAIA,KAAK,CAACoD,OAAO,EAAI,+BAA+B,CAAC,CAC3F,CAAC,OAAS,CACR7D,YAAY,CAAC,KAAK,CAAC,CACrB,CACF,CAAC,CAED,KAAM,CAAA8F,wBAAwB,CAAG,KAAO,CAAA/B,aAAqB,EAAK,CAChE,GAAI,CACFwB,eAAe,CAAC,IAAI,CAAC,CACrBC,QAAQ,CAAC,EAAE,CAAC,CACZ;AACA,KAAM,CAAA5H,eAAe,CAACmI,YAAY,CAAChC,aAAa,CAAE,WAAW,CAAC,CAC9D,KAAM,CAAA1D,iBAAiB,CAAC,CAAC,CAAE;AAC7B,CAAE,MAAOI,KAAU,CAAE,KAAAuF,gBAAA,CAAAC,qBAAA,CACnBvF,OAAO,CAACD,KAAK,CAAC,8BAA8B,CAAEA,KAAK,CAAC,CACpD+E,QAAQ,CAAC,EAAAQ,gBAAA,CAAAvF,KAAK,CAACkD,QAAQ,UAAAqC,gBAAA,kBAAAC,qBAAA,CAAdD,gBAAA,CAAgBpC,IAAI,UAAAqC,qBAAA,iBAApBA,qBAAA,CAAsBxF,KAAK,GAAIA,KAAK,CAACoD,OAAO,EAAI,+BAA+B,CAAC,CAC3F,CAAC,OAAS,CACR0B,eAAe,CAAC,KAAK,CAAC,CACxB,CACF,CAAC,CAED,KAAM,CAAAW,uBAAuB,CAAG,KAAAA,CAAOnC,aAAqB,CAAEoC,MAAc,GAAK,CAC/E,GAAI,CACFZ,eAAe,CAAC,IAAI,CAAC,CACrBC,QAAQ,CAAC,EAAE,CAAC,CACZ;AACA,KAAM,CAAA5H,eAAe,CAACmI,YAAY,CAAChC,aAAa,CAAE,WAAW,CAAC,CAC9D,KAAM,CAAA1D,iBAAiB,CAAC,CAAC,CAAE;AAC7B,CAAE,MAAOI,KAAU,CAAE,KAAA2F,gBAAA,CAAAC,qBAAA,CACnB3F,OAAO,CAACD,KAAK,CAAC,8BAA8B,CAAEA,KAAK,CAAC,CACpD+E,QAAQ,CAAC,EAAAY,gBAAA,CAAA3F,KAAK,CAACkD,QAAQ,UAAAyC,gBAAA,kBAAAC,qBAAA,CAAdD,gBAAA,CAAgBxC,IAAI,UAAAyC,qBAAA,iBAApBA,qBAAA,CAAsB5F,KAAK,GAAIA,KAAK,CAACoD,OAAO,EAAI,8BAA8B,CAAC,CAC1F,CAAC,OAAS,CACR0B,eAAe,CAAC,KAAK,CAAC,CACxB,CACF,CAAC,CAED,KAAM,CAAAe,yBAAyB,CAAG,KAAO,CAAAC,SAAgB,EAAK,CAC5D,GAAI,CACFhB,eAAe,CAAC,IAAI,CAAC,CACrBC,QAAQ,CAAC,EAAE,CAAC,CACZ;AACA9E,OAAO,CAACC,GAAG,CAAC,kCAAkC,CAAE4F,SAAS,CAAC,CAC1DlB,gBAAgB,CAACkB,SAAS,CAAC,CAC3B;AACA,KAAM,IAAI,CAAAxF,OAAO,CAACyF,OAAO,EAAI9B,UAAU,CAAC8B,OAAO,CAAE,IAAI,CAAC,CAAC,CACzD,CAAE,MAAO/F,KAAU,CAAE,KAAAgG,gBAAA,CAAAC,qBAAA,CACnBhG,OAAO,CAACD,KAAK,CAAC,gCAAgC,CAAEA,KAAK,CAAC,CACtD+E,QAAQ,CAAC,EAAAiB,gBAAA,CAAAhG,KAAK,CAACkD,QAAQ,UAAA8C,gBAAA,kBAAAC,qBAAA,CAAdD,gBAAA,CAAgB7C,IAAI,UAAA8C,qBAAA,iBAApBA,qBAAA,CAAsBjG,KAAK,GAAIA,KAAK,CAACoD,OAAO,EAAI,iCAAiC,CAAC,CAC7F,CAAC,OAAS,CACR0B,eAAe,CAAC,KAAK,CAAC,CACxB,CACF,CAAC,CAED,KAAM,CAAAoB,wBAAwB,CAAG,KAAO,CAAA7G,SAAiB,EAAK,CAC5D,GAAI,CACF0F,QAAQ,CAAC,EAAE,CAAC,CACZ;AACA9E,OAAO,CAACC,GAAG,CAAC,qCAAqC,CAAEb,SAAS,CAAC,CAC/D,CAAE,MAAOW,KAAU,CAAE,KAAAmG,gBAAA,CAAAC,qBAAA,CACnBnG,OAAO,CAACD,KAAK,CAAC,gCAAgC,CAAEA,KAAK,CAAC,CACtD+E,QAAQ,CAAC,EAAAoB,gBAAA,CAAAnG,KAAK,CAACkD,QAAQ,UAAAiD,gBAAA,kBAAAC,qBAAA,CAAdD,gBAAA,CAAgBhD,IAAI,UAAAiD,qBAAA,iBAApBA,qBAAA,CAAsBpG,KAAK,GAAIA,KAAK,CAACoD,OAAO,EAAI,gCAAgC,CAAC,CAC5F,CACF,CAAC,CAEDhH,KAAK,CAAC2H,SAAS,CAAC,IAAM,CACpB;AACA,KAAM,CAAAC,KAAK,CAAGC,UAAU,CAAC,IAAM,CAC7BrE,iBAAiB,CAAC,CAAC,CACrB,CAAC,CAAE,GAAG,CAAC,CAEP,MAAO,IAAMsE,YAAY,CAACF,KAAK,CAAC,CAClC,CAAC,CAAE,CAACrF,IAAI,CAACoB,EAAE,CAAC,CAAC,CAEb;AACA,MAAO,CAAA/B,QAAQ,CAAC,CACdW,IAAI,CACJC,YAAY,CACZ6F,QAAQ,CACRE,aAAa,CACbxG,SAAS,CACT0G,YAAY,CACZ7E,KAAK,CACLqG,oBAAoB,CAAEhB,wBAAwB,CAC9CiB,mBAAmB,CAAEb,uBAAuB,CAC5Cc,qBAAqB,CAAEV,yBAAyB,CAChDW,oBAAoB,CAAEN,wBACxB,CAAC,CAAC,CACJ,CAAC,CAED;AACA,KAAM,CAAAO,qBAGJ,CAAGC,KAAA,EAAwB,IAAvB,CAAE1I,QAAQ,CAAEW,IAAK,CAAC,CAAA+H,KAAA,CACtB,KAAM,CAAC9H,YAAY,CAAEC,eAAe,CAAC,CAAGzC,KAAK,CAAC0C,QAAQ,CAAQ,EAAE,CAAC,CACjE,KAAM,CAACC,QAAQ,CAAEC,WAAW,CAAC,CAAG5C,KAAK,CAAC0C,QAAQ,CAAQ,EAAE,CAAC,CACzD,KAAM,CAACG,OAAO,CAAEC,UAAU,CAAC,CAAG9C,KAAK,CAAC0C,QAAQ,CAAQ,EAAE,CAAC,CACvD,KAAM,CAACX,SAAS,CAAEoB,YAAY,CAAC,CAAGnD,KAAK,CAAC0C,QAAQ,CAAC,IAAI,CAAC,CACtD,KAAM,CAAC+F,YAAY,CAAEC,eAAe,CAAC,CAAG1I,KAAK,CAAC0C,QAAQ,CAAC,KAAK,CAAC,CAC7D,KAAM,CAACkB,KAAK,CAAE+E,QAAQ,CAAC,CAAG3I,KAAK,CAAC0C,QAAQ,CAAC,EAAE,CAAC,CAE5C,KAAM,CAAAc,iBAAiB,CAAG,KAAAA,CAAA,GAAY,CACpC,GAAI,CACFL,YAAY,CAAC,IAAI,CAAC,CAClBwF,QAAQ,CAAC,EAAE,CAAC,CAEZ;AACA,GAAI,CACF,KAAM,CAAA5E,gBAAgB,CAAG,KAAM,CAAAhD,eAAe,CAACsD,MAAM,CAAC,CAAC,CACvD5B,eAAe,CAACsB,gBAAgB,CAAC,CACnC,CAAE,MAAO6E,iBAAiB,CAAE,CAC1B/E,OAAO,CAACC,GAAG,CAAC,wCAAwC,CAAC,CACrDrB,eAAe,CAAC,EAAE,CAAC,CACrB,CAEA;AACA,GAAI,CACF,KAAM,CAAAuB,YAAY,CAAG,KAAM,CAAAhD,WAAW,CAACqD,MAAM,CAAC,CAAC,CAC/CzB,WAAW,CAACoB,YAAY,CAAC,CAC3B,CAAE,MAAOuG,aAAa,CAAE,CACtB1G,OAAO,CAACC,GAAG,CAAC,oCAAoC,CAAC,CACjDlB,WAAW,CAAC,EAAE,CAAC,CACjB,CAEA;AACA,GAAI,CACF,KAAM,CAAA4H,SAAS,CAAG,KAAM,CAAAtJ,QAAQ,CAACmD,MAAM,CAAC,CAAC,CACzC,KAAM,CAAAJ,WAAW,CAAGuG,SAAS,CAAClF,MAAM,CAAEmF,KAAU,EAAKA,KAAK,CAACC,IAAI,GAAK,QAAQ,CAAC,CAC7E5H,UAAU,CAACmB,WAAW,CAAC,CACzB,CAAE,MAAO0G,UAAU,CAAE,CACnB9G,OAAO,CAACC,GAAG,CAAC,iCAAiC,CAAC,CAC9ChB,UAAU,CAAC,EAAE,CAAC,CAChB,CACF,CAAE,MAAOc,KAAU,CAAE,KAAAgH,gBAAA,CAAAC,qBAAA,CACnBhH,OAAO,CAACD,KAAK,CAAC,qCAAqC,CAAEA,KAAK,CAAC,CAC3D+E,QAAQ,CAAC,EAAAiC,gBAAA,CAAAhH,KAAK,CAACkD,QAAQ,UAAA8D,gBAAA,kBAAAC,qBAAA,CAAdD,gBAAA,CAAgB7D,IAAI,UAAA8D,qBAAA,iBAApBA,qBAAA,CAAsBjH,KAAK,GAAIA,KAAK,CAACoD,OAAO,EAAI,+BAA+B,CAAC,CAC3F,CAAC,OAAS,CACR7D,YAAY,CAAC,KAAK,CAAC,CACrB,CACF,CAAC,CAEDnD,KAAK,CAAC2H,SAAS,CAAC,IAAM,CACpBnE,iBAAiB,CAAC,CAAC,CACrB,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAsH,2BAA2B,CAAG,KAAO,CAAAC,eAAoB,EAAK,CAClE,GAAI,CACFrC,eAAe,CAAC,IAAI,CAAC,CACrBC,QAAQ,CAAC,EAAE,CAAC,CAEZ;AACA,KAAM,CAAAqC,iBAAiB,CAAAC,aAAA,CAAAA,aAAA,IAClBF,eAAe,MAClBrE,eAAe,CAAE,GAAI,CAAAxB,IAAI,CAAC,CAAC,CAACgG,WAAW,CAAC,CAAC,CAACjF,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAE;AACzDF,SAAS,CAAE,GAAI,CAAAb,IAAI,CAAC,CAAC,CAACoB,YAAY,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC,CAAE;AAClD4E,MAAM,CAAE,QAAQ,CAChBxE,KAAK,yBAAAT,MAAA,CAA0B6E,eAAe,CAACpE,KAAK,EAAI,qBAAqB,CAAE,EAChF,CAED,KAAM,CAAA5F,eAAe,CAACyF,MAAM,CAACwE,iBAAiB,CAAC,CAC/C,KAAM,CAAAxH,iBAAiB,CAAC,CAAC,CAAE;AAC7B,CAAE,MAAOI,KAAU,CAAE,KAAAwH,gBAAA,CAAAC,qBAAA,CACnBxH,OAAO,CAACD,KAAK,CAAC,oCAAoC,CAAEA,KAAK,CAAC,CAC1D+E,QAAQ,CAAC,EAAAyC,gBAAA,CAAAxH,KAAK,CAACkD,QAAQ,UAAAsE,gBAAA,kBAAAC,qBAAA,CAAdD,gBAAA,CAAgBrE,IAAI,UAAAsE,qBAAA,iBAApBA,qBAAA,CAAsBzH,KAAK,GAAIA,KAAK,CAACoD,OAAO,EAAI,oCAAoC,CAAC,CAChG,CAAC,OAAS,CACR0B,eAAe,CAAC,KAAK,CAAC,CACxB,CACF,CAAC,CAED,KAAM,CAAA4C,iCAAiC,CAAG,KAAAA,CAAOpE,aAAqB,CAAEqE,QAAgB,GAAK,CAC3F,GAAI,CACF7C,eAAe,CAAC,IAAI,CAAC,CACrBC,QAAQ,CAAC,EAAE,CAAC,CAEZ;AACA,KAAM,CAAA5H,eAAe,CAACqG,MAAM,CAACF,aAAa,CAAE,CAC1CT,OAAO,CAAE8E,QAAQ,CACjBJ,MAAM,CAAE,WACV,CAAC,CAAC,CAEF,KAAM,CAAA3H,iBAAiB,CAAC,CAAC,CAAE;AAC7B,CAAE,MAAOI,KAAU,CAAE,KAAA4H,gBAAA,CAAAC,qBAAA,CACnB5H,OAAO,CAACD,KAAK,CAAC,yCAAyC,CAAEA,KAAK,CAAC,CAC/D+E,QAAQ,CAAC,EAAA6C,gBAAA,CAAA5H,KAAK,CAACkD,QAAQ,UAAA0E,gBAAA,kBAAAC,qBAAA,CAAdD,gBAAA,CAAgBzE,IAAI,UAAA0E,qBAAA,iBAApBA,qBAAA,CAAsB7H,KAAK,GAAIA,KAAK,CAACoD,OAAO,EAAI,+BAA+B,CAAC,CAC3F,CAAC,OAAS,CACR0B,eAAe,CAAC,KAAK,CAAC,CACxB,CACF,CAAC,CAED,KAAM,CAAAW,uBAAuB,CAAG,KAAAA,CAAOnC,aAAqB,CAAEoC,MAAc,GAAK,CAC/E,GAAI,CACFZ,eAAe,CAAC,IAAI,CAAC,CACrBC,QAAQ,CAAC,EAAE,CAAC,CAEZ,KAAM,CAAA5H,eAAe,CAACqG,MAAM,CAACF,aAAa,CAAE,CAC1CiE,MAAM,CAAE,WAAW,CACnBxE,KAAK,uBAAAT,MAAA,CAAwBoD,MAAM,CACrC,CAAC,CAAC,CAEF,KAAM,CAAA9F,iBAAiB,CAAC,CAAC,CAAE;AAC7B,CAAE,MAAOI,KAAU,CAAE,KAAA8H,iBAAA,CAAAC,qBAAA,CACnB9H,OAAO,CAACD,KAAK,CAAC,8BAA8B,CAAEA,KAAK,CAAC,CACpD+E,QAAQ,CAAC,EAAA+C,iBAAA,CAAA9H,KAAK,CAACkD,QAAQ,UAAA4E,iBAAA,kBAAAC,qBAAA,CAAdD,iBAAA,CAAgB3E,IAAI,UAAA4E,qBAAA,iBAApBA,qBAAA,CAAsB/H,KAAK,GAAIA,KAAK,CAACoD,OAAO,EAAI,8BAA8B,CAAC,CAC1F,CAAC,OAAS,CACR0B,eAAe,CAAC,KAAK,CAAC,CACxB,CACF,CAAC,CAED,MAAO,CAAA9G,QAAQ,CAAC,CACdW,IAAI,CACJC,YAAY,CACZG,QAAQ,CACRE,OAAO,CACPd,SAAS,CACT0G,YAAY,CACZ7E,KAAK,CACLgI,uBAAuB,CAAEd,2BAA2B,CACpDe,6BAA6B,CAAEP,iCAAiC,CAChEpB,mBAAmB,CAAEb,uBAAuB,CAC5CyC,QAAQ,CAAEA,CAAA,GAAM,CACdC,YAAY,CAACC,UAAU,CAAC,OAAO,CAAC,CAChCC,MAAM,CAACC,QAAQ,CAACC,IAAI,CAAG,OAAO,CAChC,CACF,CAAC,CAAC,CACJ,CAAC,CAED;AACA,KAAM,CAAAC,qBAGJ,CAAGC,KAAA,EAAwB,IAAvB,CAAEzK,QAAQ,CAAEW,IAAK,CAAC,CAAA8J,KAAA,CACtB,KAAM,CAACC,KAAK,CAAEC,QAAQ,CAAC,CAAGvM,KAAK,CAAC0C,QAAQ,CAAQ,EAAE,CAAC,CACnD,KAAM,CAACF,YAAY,CAAEC,eAAe,CAAC,CAAGzC,KAAK,CAAC0C,QAAQ,CAAQ,EAAE,CAAC,CACjE,KAAM,CAACC,QAAQ,CAAEC,WAAW,CAAC,CAAG5C,KAAK,CAAC0C,QAAQ,CAAQ,EAAE,CAAC,CACzD,KAAM,CAACX,SAAS,CAAEoB,YAAY,CAAC,CAAGnD,KAAK,CAAC0C,QAAQ,CAAC,IAAI,CAAC,CACtD,KAAM,CAAC+F,YAAY,CAAEC,eAAe,CAAC,CAAG1I,KAAK,CAAC0C,QAAQ,CAAC,KAAK,CAAC,CAC7D,KAAM,CAACkB,KAAK,CAAE+E,QAAQ,CAAC,CAAG3I,KAAK,CAAC0C,QAAQ,CAAC,EAAE,CAAC,CAE5C,KAAM,CAAAc,iBAAiB,CAAG,KAAAA,CAAA,GAAY,CACpC,GAAI,CACFL,YAAY,CAAC,IAAI,CAAC,CAClBwF,QAAQ,CAAC,EAAE,CAAC,CAEZ;AACA,GAAI,CACF,KAAM,CAAA6B,SAAS,CAAG,KAAM,CAAAtJ,QAAQ,CAACmD,MAAM,CAAC,CAAC,CACzCR,OAAO,CAACC,GAAG,CAAC,sBAAsB,CAAE0G,SAAS,CAAC,CAC9C+B,QAAQ,CAAC/B,SAAS,CAAC,CACrB,CAAE,MAAOG,UAAU,CAAE,CACnB9G,OAAO,CAACC,GAAG,CAAC,oDAAoD,CAAC,CACjE,KAAM,CAAA0I,SAAS,CAAG,KAAM,CAAArL,QAAQ,CAACsL,QAAQ,CAAC,CAAC,CAC3C5I,OAAO,CAACC,GAAG,CAAC,sBAAsB,CAAE0I,SAAS,CAAC,CAC9CD,QAAQ,CAACC,SAAS,CAAC,CACrB,CAEA;AACA,GAAI,CACF;AACA,KAAM,CAAAzI,gBAAgB,CAAG,KAAM,CAAAhD,eAAe,CAACsD,MAAM,CAAC,CAAC,CACvD5B,eAAe,CAACsB,gBAAgB,CAAC,CACnC,CAAE,MAAO6E,iBAAiB,CAAE,CAC1B/E,OAAO,CAACC,GAAG,CAAC,wCAAwC,CAAC,CACrDrB,eAAe,CAAC,EAAE,CAAC,CACrB,CAEA;AACA,GAAI,CACF,KAAM,CAAAuB,YAAY,CAAG,KAAM,CAAAhD,WAAW,CAACqD,MAAM,CAAC,CAAC,CAC/CzB,WAAW,CAACoB,YAAY,CAAC,CAC3B,CAAE,MAAOuG,aAAa,CAAE,CACtB1G,OAAO,CAACC,GAAG,CAAC,oCAAoC,CAAC,CACjDlB,WAAW,CAAC,EAAE,CAAC,CACjB,CACF,CAAE,MAAOgB,KAAU,CAAE,KAAA8I,iBAAA,CAAAC,qBAAA,CACnB9I,OAAO,CAACD,KAAK,CAAC,qCAAqC,CAAEA,KAAK,CAAC,CAC3D+E,QAAQ,CAAC,EAAA+D,iBAAA,CAAA9I,KAAK,CAACkD,QAAQ,UAAA4F,iBAAA,kBAAAC,qBAAA,CAAdD,iBAAA,CAAgB3F,IAAI,UAAA4F,qBAAA,iBAApBA,qBAAA,CAAsB/I,KAAK,GAAIA,KAAK,CAACoD,OAAO,EAAI,+BAA+B,CAAC,CAC3F,CAAC,OAAS,CACR7D,YAAY,CAAC,KAAK,CAAC,CACrB,CACF,CAAC,CAED,KAAM,CAAAyJ,sBAAsB,CAAG,KAAAA,CAAOC,MAAc,CAAEC,QAAiB,GAAK,CAC1E,GAAI,CACFpE,eAAe,CAAC,IAAI,CAAC,CACrBC,QAAQ,CAAC,EAAE,CAAC,CACZ,KAAM,CAAAxH,QAAQ,CAAC4L,gBAAgB,CAACF,MAAM,CAAEC,QAAQ,CAAC,CACjD,KAAM,CAAAtJ,iBAAiB,CAAC,CAAC,CAAE;AAC7B,CAAE,MAAOI,KAAU,CAAE,KAAAoJ,iBAAA,CAAAC,qBAAA,CACnBpJ,OAAO,CAACD,KAAK,CAAC,6BAA6B,CAAEA,KAAK,CAAC,CACnD+E,QAAQ,CAAC,EAAAqE,iBAAA,CAAApJ,KAAK,CAACkD,QAAQ,UAAAkG,iBAAA,kBAAAC,qBAAA,CAAdD,iBAAA,CAAgBjG,IAAI,UAAAkG,qBAAA,iBAApBA,qBAAA,CAAsBrJ,KAAK,GAAIA,KAAK,CAACoD,OAAO,EAAI,8BAA8B,CAAC,CAC1F,CAAC,OAAS,CACR0B,eAAe,CAAC,KAAK,CAAC,CACxB,CACF,CAAC,CAED,KAAM,CAAAwE,oBAAoB,CAAG,KAAAA,CAAOL,MAAc,CAAEM,OAAe,GAAK,CACtE,GAAI,CACFzE,eAAe,CAAC,IAAI,CAAC,CACrBC,QAAQ,CAAC,EAAE,CAAC,CACZ,KAAM,CAAAxH,QAAQ,CAACiM,cAAc,CAACP,MAAM,CAAEM,OAAO,CAAC,CAC9C,KAAM,CAAA3J,iBAAiB,CAAC,CAAC,CAAE;AAC7B,CAAE,MAAOI,KAAU,CAAE,KAAAyJ,iBAAA,CAAAC,qBAAA,CACnBzJ,OAAO,CAACD,KAAK,CAAC,2BAA2B,CAAEA,KAAK,CAAC,CACjD+E,QAAQ,CAAC,EAAA0E,iBAAA,CAAAzJ,KAAK,CAACkD,QAAQ,UAAAuG,iBAAA,kBAAAC,qBAAA,CAAdD,iBAAA,CAAgBtG,IAAI,UAAAuG,qBAAA,iBAApBA,qBAAA,CAAsB1J,KAAK,GAAIA,KAAK,CAACoD,OAAO,EAAI,4BAA4B,CAAC,CACxF,CAAC,OAAS,CACR0B,eAAe,CAAC,KAAK,CAAC,CACxB,CACF,CAAC,CAED,KAAM,CAAA6E,iBAAiB,CAAG,KAAO,CAAA/C,SAAc,EAAK,CAClD,GAAI,CACF9B,eAAe,CAAC,IAAI,CAAC,CACrBC,QAAQ,CAAC,EAAE,CAAC,CACZ,KAAM,CAAAxH,QAAQ,CAACqM,WAAW,CAAChD,SAAS,CAAC,CACrC,KAAM,CAAAhH,iBAAiB,CAAC,CAAC,CAAE;AAC7B,CAAE,MAAOI,KAAU,CAAE,KAAA6J,iBAAA,CAAAC,qBAAA,CACnB7J,OAAO,CAACD,KAAK,CAAC,uBAAuB,CAAEA,KAAK,CAAC,CAC7C+E,QAAQ,CAAC,EAAA8E,iBAAA,CAAA7J,KAAK,CAACkD,QAAQ,UAAA2G,iBAAA,kBAAAC,qBAAA,CAAdD,iBAAA,CAAgB1G,IAAI,UAAA2G,qBAAA,iBAApBA,qBAAA,CAAsB9J,KAAK,GAAIA,KAAK,CAACoD,OAAO,EAAI,+BAA+B,CAAC,CAC3F,CAAC,OAAS,CACR0B,eAAe,CAAC,KAAK,CAAC,CACxB,CACF,CAAC,CAED,KAAM,CAAAiF,mBAAmB,CAAG,KAAO,CAAAC,WAAgB,EAAK,CACtD,GAAI,CACFlF,eAAe,CAAC,IAAI,CAAC,CACrBC,QAAQ,CAAC,EAAE,CAAC,CACZ,KAAM,CAAA3H,WAAW,CAACwF,MAAM,CAACoH,WAAW,CAAC,CACrC,KAAM,CAAApK,iBAAiB,CAAC,CAAC,CAAE;AAC7B,CAAE,MAAOI,KAAU,CAAE,KAAAiK,iBAAA,CAAAC,qBAAA,CACnBjK,OAAO,CAACD,KAAK,CAAC,yBAAyB,CAAEA,KAAK,CAAC,CAC/C+E,QAAQ,CAAC,EAAAkF,iBAAA,CAAAjK,KAAK,CAACkD,QAAQ,UAAA+G,iBAAA,kBAAAC,qBAAA,CAAdD,iBAAA,CAAgB9G,IAAI,UAAA+G,qBAAA,iBAApBA,qBAAA,CAAsBlK,KAAK,GAAIA,KAAK,CAACoD,OAAO,EAAI,0BAA0B,CAAC,CACtF,CAAC,OAAS,CACR0B,eAAe,CAAC,KAAK,CAAC,CACxB,CACF,CAAC,CAED,KAAM,CAAAqF,mBAAmB,CAAG,KAAAA,CAAOlI,SAAiB,CAAE+H,WAAgB,GAAK,CACzE,GAAI,CACFlF,eAAe,CAAC,IAAI,CAAC,CACrBC,QAAQ,CAAC,EAAE,CAAC,CACZ,KAAM,CAAA3H,WAAW,CAACoG,MAAM,CAACvB,SAAS,CAAE+H,WAAW,CAAC,CAChD,KAAM,CAAApK,iBAAiB,CAAC,CAAC,CAAE;AAC7B,CAAE,MAAOI,KAAU,CAAE,KAAAoK,iBAAA,CAAAC,qBAAA,CACnBpK,OAAO,CAACD,KAAK,CAAC,yBAAyB,CAAEA,KAAK,CAAC,CAC/C+E,QAAQ,CAAC,EAAAqF,iBAAA,CAAApK,KAAK,CAACkD,QAAQ,UAAAkH,iBAAA,kBAAAC,qBAAA,CAAdD,iBAAA,CAAgBjH,IAAI,UAAAkH,qBAAA,iBAApBA,qBAAA,CAAsBrK,KAAK,GAAIA,KAAK,CAACoD,OAAO,EAAI,0BAA0B,CAAC,CACtF,CAAC,OAAS,CACR0B,eAAe,CAAC,KAAK,CAAC,CACxB,CACF,CAAC,CAED,KAAM,CAAAwF,mBAAmB,CAAG,KAAO,CAAArI,SAAiB,EAAK,CACvD,GAAI,CACF6C,eAAe,CAAC,IAAI,CAAC,CACrBC,QAAQ,CAAC,EAAE,CAAC,CAEZ;AACA,KAAM,CAAAwF,wBAAwB,CAAG3L,YAAY,CAAC8C,MAAM,CAAC8I,GAAG,EAAIA,GAAG,CAACC,OAAO,CAAC1K,EAAE,GAAKkC,SAAS,CAAC,CACzF,GAAIsI,wBAAwB,CAAC/L,MAAM,CAAG,CAAC,CAAE,CACvCuG,QAAQ,yDAAAzC,MAAA,CAAyDiI,wBAAwB,CAAC/L,MAAM,0EAAwE,CAAC,CACzK,OACF,CAEAyB,OAAO,CAACC,GAAG,CAAC,+BAA+B,CAAE+B,SAAS,CAAC,CACvD,KAAM,CAAAyI,YAAY,CAAG,KAAM,CAAAtN,WAAW,CAACwG,MAAM,CAAC3B,SAAS,CAAC,CACxDhC,OAAO,CAACC,GAAG,CAAC,gBAAgB,CAAEwK,YAAY,CAAC,CAC3C,KAAM,CAAA9K,iBAAiB,CAAC,CAAC,CAAE;AAC7B,CAAE,MAAOI,KAAU,CAAE,KAAA2K,iBAAA,CAAAC,qBAAA,CAAAC,iBAAA,CAAAC,qBAAA,CACnB7K,OAAO,CAACD,KAAK,CAAC,yBAAyB,CAAEA,KAAK,CAAC,CAE/C;AACA,GAAI,CAAA+K,YAAY,CAAG,0BAA0B,CAC7C,IAAAJ,iBAAA,CAAI3K,KAAK,CAACkD,QAAQ,UAAAyH,iBAAA,YAAAC,qBAAA,CAAdD,iBAAA,CAAgBxH,IAAI,UAAAyH,qBAAA,WAApBA,qBAAA,CAAsB5K,KAAK,CAAE,CAC/B+K,YAAY,CAAG/K,KAAK,CAACkD,QAAQ,CAACC,IAAI,CAACnD,KAAK,CAC1C,CAAC,IAAM,KAAA6K,iBAAA,CAAI7K,KAAK,CAACkD,QAAQ,UAAA2H,iBAAA,YAAAC,qBAAA,CAAdD,iBAAA,CAAgB1H,IAAI,UAAA2H,qBAAA,WAApBA,qBAAA,CAAsB1H,OAAO,CAAE,CACxC2H,YAAY,CAAG/K,KAAK,CAACkD,QAAQ,CAACC,IAAI,CAACC,OAAO,CAC5C,CAAC,IAAM,IAAIpD,KAAK,CAACoD,OAAO,CAAE,CACxB2H,YAAY,CAAG/K,KAAK,CAACoD,OAAO,CAC9B,CAEA;AACA,GAAI2H,YAAY,CAAC3I,QAAQ,CAAC,aAAa,CAAC,EAAI2I,YAAY,CAAC3I,QAAQ,CAAC,YAAY,CAAC,EAAI2I,YAAY,CAAC3I,QAAQ,CAAC,WAAW,CAAC,CAAE,CACrH2I,YAAY,CAAG,mIAAmI,CACpJ,CAEAhG,QAAQ,CAACgG,YAAY,CAAC,CACxB,CAAC,OAAS,CACRjG,eAAe,CAAC,KAAK,CAAC,CACxB,CACF,CAAC,CAED1I,KAAK,CAAC2H,SAAS,CAAC,IAAM,CACpBnE,iBAAiB,CAAC,CAAC,CACrB,CAAC,CAAE,CAACjB,IAAI,CAACoB,EAAE,CAAC,CAAC,CAEb;AACA,MAAO,CAAA/B,QAAQ,CAAC,CACdW,IAAI,CACJ+J,KAAK,CACL9J,YAAY,CACZG,QAAQ,CACRZ,SAAS,CACT0G,YAAY,CACZ7E,KAAK,CACLgL,kBAAkB,CAAEhC,sBAAsB,CAC1CiC,gBAAgB,CAAE3B,oBAAoB,CACtC4B,aAAa,CAAEvB,iBAAiB,CAChCwB,eAAe,CAAEpB,mBAAmB,CACpCqB,eAAe,CAAEjB,mBAAmB,CACpCkB,eAAe,CAAEf,mBAAmB,CACpCpC,QAAQ,CAAEA,CAAA,GAAM,CACdC,YAAY,CAACC,UAAU,CAAC,OAAO,CAAC,CAChCC,MAAM,CAACC,QAAQ,CAACC,IAAI,CAAG,OAAO,CAChC,CACF,CAAC,CAAC,CACJ,CAAC,CAED;AACA,KAAM,CAAA+C,SAAmB,CAAGA,CAAA,GAAM,KAAAC,WAAA,CAAAC,YAAA,CAAAC,YAAA,CAChC,KAAM,CAAEvN,eAAe,CAAES,IAAI,CAAE+M,KAAK,CAAEC,QAAQ,CAAEC,MAAM,CAAEzN,SAAS,CAAE6B,KAAK,CAAE6L,UAAW,CAAC,CAAGlP,OAAO,CAAC,CAAC,CAElG,KAAM,CAAAmP,WAAW,CAAG,KAAAA,CAAO9K,KAAa,CAAE+K,QAAgB,GAAK,CAC7D,GAAI,CACF,KAAM,CAAAL,KAAK,CAAC,CAAE1K,KAAK,CAAE+K,QAAS,CAAC,CAAC,CAClC,CAAE,MAAOC,GAAG,CAAE,CACZ;AAAA,CAEJ,CAAC,CAED,KAAM,CAAAC,cAAc,CAAG,KAAO,CAAAC,QAAa,EAAK,CAC9C,GAAI,CACF,KAAM,CAAAP,QAAQ,CAACO,QAAQ,CAAC,CAC1B,CAAE,MAAOF,GAAG,CAAE,CACZ;AAAA,CAEJ,CAAC,CAED,KAAM,CAAAG,YAAY,CAAGA,CAAA,GAAM,CACzBP,MAAM,CAAC,CAAC,CACV,CAAC,CAED,GAAIzN,SAAS,CAAE,CACb,mBACEV,IAAA,QAAKY,SAAS,CAAC,+CAA+C,CAAAL,QAAA,cAC5DP,IAAA,CAACP,cAAc,GAAE,CAAC,CACf,CAAC,CAEV,CAEA,mBACEW,KAAA,CAACtB,MAAM,EAAAyB,QAAA,eAELP,IAAA,CAACjB,KAAK,EAAC4P,IAAI,CAAC,GAAG,CAACC,OAAO,cAAE5O,IAAA,CAACb,WAAW,GAAE,CAAE,CAAE,CAAC,cAC5Ca,IAAA,CAACjB,KAAK,EACJ4P,IAAI,CAAC,OAAO,CACZC,OAAO,CACLnO,eAAe,cACbT,IAAA,CAAChB,QAAQ,EAAC6B,EAAE,CACVK,IAAI,SAAJA,IAAI,YAAA4M,WAAA,CAAJ5M,IAAI,CAAE2N,KAAK,UAAAf,WAAA,WAAXA,WAAA,CAAanJ,QAAQ,CAAC,OAAO,CAAC,CAAG,kBAAkB,CACnDzD,IAAI,SAAJA,IAAI,YAAA6M,YAAA,CAAJ7M,IAAI,CAAE2N,KAAK,UAAAd,YAAA,WAAXA,YAAA,CAAapJ,QAAQ,CAAC,QAAQ,CAAC,CAAG,mBAAmB,CACrDzD,IAAI,SAAJA,IAAI,YAAA8M,YAAA,CAAJ9M,IAAI,CAAE2N,KAAK,UAAAb,YAAA,WAAXA,YAAA,CAAarJ,QAAQ,CAAC,OAAO,CAAC,CAAG,kBAAkB,CACnD,oBACD,CAAC7D,OAAO,MAAE,CAAC,cAEZd,IAAA,CAACZ,QAAQ,EACP0P,OAAO,CAAET,WAAY,CACrBU,UAAU,CAAEP,cAAe,CAC3B9N,SAAS,CAAEA,SAAU,CACrB6B,KAAK,CAAEA,KAAM,CACb6L,UAAU,CAAEA,UAAW,CACxB,CAEJ,CACF,CAAC,cAGFpO,IAAA,CAACjB,KAAK,EACJ4P,IAAI,CAAC,oBAAoB,CACzBC,OAAO,cACL5O,IAAA,CAACK,cAAc,EAACG,YAAY,CAAE,CAAC,SAAS,CAAE,CAAAD,QAAA,cACxCP,IAAA,CAACgB,gBAAgB,EAACE,IAAI,CAAEA,IAAK,CAAAX,QAAA,CACzByO,KAAK,eAAKhP,IAAA,CAACX,gBAAgB,CAAAuK,aAAA,CAAAA,aAAA,IAAKoF,KAAK,MAAEvE,QAAQ,CAAEiE,YAAa,EAAE,CAAC,CACnD,CAAC,CACL,CACjB,CACF,CAAC,cAEF1O,IAAA,CAACjB,KAAK,EACJ4P,IAAI,CAAC,mBAAmB,CACxBC,OAAO,cACL5O,IAAA,CAACK,cAAc,EAACG,YAAY,CAAE,CAAC,QAAQ,CAAE,CAAAD,QAAA,cACvCP,IAAA,CAAC8G,sBAAsB,EAAC5F,IAAI,CAAEA,IAAK,CAAAX,QAAA,CAC/ByO,KAAK,eAAKhP,IAAA,CAACV,eAAe,CAAAsK,aAAA,CAAAA,aAAA,IAAKoF,KAAK,MAAEvE,QAAQ,CAAEiE,YAAa,EAAE,CAAC,CAC5C,CAAC,CACX,CACjB,CACF,CAAC,cAEF1O,IAAA,CAACjB,KAAK,EACJ4P,IAAI,CAAC,kBAAkB,CACvBC,OAAO,cACL5O,IAAA,CAACK,cAAc,EAACG,YAAY,CAAE,CAAC,OAAO,CAAE,CAAAD,QAAA,cACtCP,IAAA,CAAC+K,qBAAqB,EAAC7J,IAAI,CAAEA,IAAK,CAAAX,QAAA,CAC9ByO,KAAK,eAAKhP,IAAA,CAACT,cAAc,CAAAqK,aAAA,CAAAA,aAAA,IAAKoF,KAAK,MAAEvE,QAAQ,CAAEiE,YAAa,EAAE,CAAC,CAC5C,CAAC,CACV,CACjB,CACF,CAAC,cAEF1O,IAAA,CAACjB,KAAK,EACJ4P,IAAI,CAAC,kBAAkB,CACvBC,OAAO,cACL5O,IAAA,CAACK,cAAc,EAACG,YAAY,CAAE,CAAC,OAAO,CAAE,CAAAD,QAAA,cACtCP,IAAA,CAACgJ,qBAAqB,EAAC9H,IAAI,CAAEA,IAAK,CAAAX,QAAA,CAC9ByO,KAAK,eAAKhP,IAAA,CAACR,cAAc,CAAAoK,aAAA,CAAAA,aAAA,IAAKoF,KAAK,MAAEvE,QAAQ,CAAEiE,YAAa,EAAE,CAAC,CAC5C,CAAC,CACV,CACjB,CACF,CAAC,cAGF1O,IAAA,CAACjB,KAAK,EAAC4P,IAAI,CAAC,eAAe,CAACC,OAAO,cACjC5O,IAAA,QAAKY,SAAS,CAAC,+CAA+C,CAAAL,QAAA,cAC5DH,KAAA,QAAKQ,SAAS,CAAC,aAAa,CAAAL,QAAA,eAC1BP,IAAA,OAAIY,SAAS,CAAC,yCAAyC,CAAAL,QAAA,CAAC,cAAY,CAAI,CAAC,cACzEP,IAAA,MAAGY,SAAS,CAAC,4BAA4B,CAAAL,QAAA,CAAC,gDAA8C,CAAG,CAAC,cAC5FP,IAAA,WACEiP,OAAO,CAAEP,YAAa,CACtB9N,SAAS,CAAC,6EAA6E,CAAAL,QAAA,CACxF,UAED,CAAQ,CAAC,EACN,CAAC,CACH,CACN,CAAE,CAAC,cAEJP,IAAA,CAACjB,KAAK,EAAC4P,IAAI,CAAC,GAAG,CAACC,OAAO,cAAE5O,IAAA,CAAChB,QAAQ,EAAC6B,EAAE,CAAC,GAAG,CAACC,OAAO,MAAE,CAAE,CAAE,CAAC,EAClD,CAAC,CAEb,CAAC,CAED;AACA,KAAM,CAAAoO,GAAa,CAAGA,CAAA,GAAM,CAC1B,mBACElP,IAAA,CAACf,YAAY,EAAAsB,QAAA,cACXP,IAAA,CAACnB,MAAM,EAACsQ,MAAM,CAAE,CAAEC,kBAAkB,CAAE,IAAI,CAAEC,oBAAoB,CAAE,IAAK,CAAE,CAAA9O,QAAA,cACvEP,IAAA,QAAKY,SAAS,CAAC,KAAK,CAAAL,QAAA,cAClBP,IAAA,CAAC6N,SAAS,GAAE,CAAC,CACV,CAAC,CACA,CAAC,CACG,CAAC,CAEnB,CAAC,CAED,cAAe,CAAAqB,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}